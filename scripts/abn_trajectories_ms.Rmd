---
title: "The impermanence of cropland abandonment limits potential for environmental benefits (draft)"
author: Christopher L. Crawford,$^a$$^*$ He Yin,$^b$ Volker C. Radeloff,$^c$ and David S. Wilcove$^{a, d}$
date: "`r format(Sys.time(), '%B %d, %Y')`"
abstract: |
  | $^a$Princeton School of Public and International Affairs, Princeton University, Princeton, NJ
  | $^b$Department of Geography, Kent State University, Kent, OH
  | $^c$Department of Forest & Wildlife Ecology, University of Wisconsin - Madison, Madison, WI
  | $^d$Department of Ecology & Evolutionary Biology, Princeton University, Princeton, NJ
  |
  | $^*$Corresponding Author, ccrawford@princeton.edu, Robertson Hall, Princeton University, Princeton, NJ
output:
  bookdown::word_document2:
    reference_docx: /Users/christophercrawford/Google_Drive/_Projects/writing/scripts/word_style_ref.docx
    number_sections: false
  bookdown::pdf_document2:
    keep_tex: true
  bookdown::html_document2:
    toc: true
editor_options:
  chunk_output_type: console
bibliography: [/Users/christophercrawford/Google_Drive/Library/library.bib, packages.bib]
csl: pnas.csl
nocite: |
  @RStudio, @R-rmarkdown, @R-bookdown, @R-knitr
header-includes:
  \newcommand{\beginsupplement}{\setcounter{figure}{0} \setcounter{section}{0} \setcounter{table}{0} \setcounter{equation}{0} \renewcommand{\thefigure}{S\arabic{figure}} \renewcommand{\thesection}{S\arabic{section}} \renewcommand{\thetable}{S\arabic{table}} \renewcommand\theequation{S\arabic{equation}}}
---
```{r preview-chapter, eval=FALSE, include = FALSE}
rmarkdown::render("scripts/abn_trajectories_ms.Rmd",
                  output_file = paste0(p_proj, "writing/previews/", "abn_duration_draft", 
                                       format(Sys.Date(), ("_%Y_%m_%d")), ".docx"))


# Save PDF with SI for linking below:
rmarkdown::render("scripts/abn_trajectories_ms.Rmd",
                  output_file = paste0(p_proj, "writing/previews/", "abn_duration_draft_w_SI.pdf"),
                  output_format = "bookdown::pdf_document2")

# bookdown::preview_chapter(
#   input = "abn_trajectories_ms.Rmd",
#   output_format = "bookdown::word_document2",
#   output_file = paste0("abn_duration_draft", format(Sys.Date(), ("_%Y_%m_%d")), ".docx"),
#   output_dir = paste0(p_proj, "writing/previews"),
#   output_options = 
#     list(reference_docx = "/Users/christophercrawford/Google_Drive/_Projects/writing/scripts/word_style_ref.docx"),
#   preview = TRUE)
```

```{r set-chunk-opts, include = FALSE}
# set default chunk options
knitr::opts_chunk$set(
  out.width = "1\\textwidth",  # if compiling a pdf, include this option
  # comment = NA,
  # fig.width=6, fig.height=6, 
  echo = FALSE # the code itself will NOT be printed with results
  )
```
```{r load-packages-functions, eval = TRUE, echo = FALSE, include = FALSE}
source("/Users/christophercrawford/Google_Drive/_Projects/abandonment_trajectories/scripts/0_start.R")
source(paste0(p_proj, "scripts/util/_util_master.R"))
# devtools::install_github("benmarwick/wordcountaddin", type = "source", dependencies = TRUE)
```

```{r produce-package-bib, include = FALSE, echo = FALSE}
# needed_packages
# github_packages
knitr::write_bib(x = c(needed_packages, github_packages), file = 'packages.bib')
# knitr::write_bib(x = c("car"), file = 'extra.bib')

# citation(package = needed_packages[1])

# knitr::write_bib(x = c(needed_packages[c(14)]), file = 'packages_top.bib')
# 
# needed_packages[1]
# packageDescription(needed_packages[1])
```

```{r load-files, include = FALSE}
# set run:
run_label <- "_2021_03_13"

# Additional paths --------------------------------------------------- #
p_plots <- "/Users/christophercrawford/Google_Drive/_Projects/abandonment_trajectories/output/plots/"

# load general spatial data on site locations --------------------------------------------------- #
site_df <- read.csv(file = paste0(p_dat_derived, "site_df.csv"))
site_df_w_size <- read.csv(file = paste0(p_dat_derived, "site_df_w_size.csv"))
site_sf <- st_read(paste0(p_dat_derived, "site_sf.shp"))


# load all length data (distilled)
length_distill_df <- read_csv(file = paste0(p_dat_derived, run_label, "/", 
                                            "length_distill_df", run_label, ".csv"))

# load mean length data
mean_length_df <- read_csv(file = paste0(p_dat_derived, run_label, "/", "mean_length_df", run_label, ".csv"))


# load summary statistic derived from lengths
summary_stats_all_sites <- read_csv(file = paste0(p_dat_derived, run_label, "/", "summary_stats_all_siteS", run_label, ".csv"))
summary_stats_all_sites_pooled <- read_csv(file = paste0(p_dat_derived, run_label, "/", "summary_stats_all_sites_pooled", run_label, ".csv"))

# load area summary stats:
area_summary_df <- read_csv(file = paste0(p_dat_derived, run_label, "/", "area_summary_df", run_label, ".csv"))
area_recult_threshold <- read_csv(file = paste0(p_dat_derived, run_label, "/", "area_recult_threshold", run_label, ".csv"))


# load stats on proportion of abandoned cropland by land cover
abn_lc_count_2017 <- read_csv(file = paste0(p_dat_derived, run_label, "/", "abn_lc_count_2017", run_label, ".csv"))
abn_prop_lc_2017 <- read_csv(file = paste0(p_dat_derived, run_label, "/", "abn_prop_lc_2017", run_label, ".csv"))


# load combined persistence, area, and turnover datasets:
persistence_dat <- read_csv(file = paste0(p_dat_derived, "abn_decay_data", run_label, ".csv")) %>%
  mutate(site = as.factor(site),
         bins = as.factor(bins),
         year_abn_bins = as.factor(year_abn_bins),
         cohort = as.factor(cohort))

area_dat <- read_csv(file = paste0(p_dat_derived, "area_dat", run_label, ".csv"))
turnover_dat <- read_csv(file = paste0(p_dat_derived, "turnover_dat", run_label, ".csv"))



# load decay rate data
load(file = paste0(p_dat_derived, run_label, "/decay_mod_coef_dfs.rds"), 
     verbose = TRUE)

# load extrapolation data
extrapolate_df_l3 <- read_csv(file = paste0(p_dat_derived, run_label, "/extrapolate_df_l3", run_label, ".csv"))


# load data for shaanxi maps --------------------------------------------------- #

# load data for decay models --------------------------------------------------- #
fitted_df_l3 <- read_csv(file = paste0(p_dat_derived, run_label, "/decay_mod_fitted_df_l3", run_label, ".csv"))

load(file = paste0(p_dat_derived, run_label, "/decay_mod_coef_dfs.rds"), verbose = TRUE)
# contains:
# coef_df_l3, coef_df_wide_l3, mean_coef_df_l3, mean_coef_df_wide_l3, mean_coef_proj_l3, time_to_l3


# load extrapolation data
extrapolate_df_l3 <- read_csv(file = paste0(p_dat_derived, run_label, "/extrapolate_df_l3", run_label, ".csv"))

future_df_l3 <- read_csv(file = paste0(p_dat_derived, run_label, "/future_df_l3", run_label, ".csv"))
```

```{r misc-notes, eval = FALSE}
# --------------------------------------------------
# Miscellaneous YAML
# --------------------------------------------------

# 
# - $^a$Princeton School of Public and International Affairs, Princeton University, Princeton, NJ
# - $^b$Department of Geography, Kent State University, Kent, OH
# - $^c$Department of Forest & Wildlife Ecology, University of Wisconsin - Madison, Madison, WI
# - $^d$Department of Ecology & Evolutionary Biology, Princeton University, Princeton, NJ
# 

# date: '`r format(Sys.Date(), "%B %d, %Y")`'
# 
# - Christopher L. Crawford^[Corresponding Author, ccrawford@princeton.edu, Robertson
#   Hall, Princeton University, Princeton, NJ] ^[Princeton University]
# - He Yin^[Kent State University]
# - Volker Radeloff^[University of Wisconsin, Madison]
# - David S. Wilcove^[Princeton University]

# author:
# - Christopher L. Crawford^[Corresponding Author, ccrawford@princeton.edu, Robertson Hall, Princeton University, Princeton, NJ] $^1$
# - He Yin$^2$
# - Volker Radeloff$^3$
# - David S. Wilcove$^{1, 4}$
# date: 
#   $^1$Princeton School of Public and International Affairs, Princeton University, Princeton, NJ \newline 
#   $^2$Department of Geography, Kent State University, Kent, OH \newline 
#   $^3$Department of Forest & Wildlife Ecology, University of Wisconsin - Madison, Madison, WI \newline 
#   $^4$Department of Ecology & Evolutionary Biology, Princeton University, Princeton, NJ


# --------------------------------------------------
# rmd-tips
# --------------------------------------------------

# Reference sections by including a tag directly after a header, such as {#section-label}, and then reference in line with the following:
# See Section \@ref(section-label)


# figures:
# this is a chunk for including a pre-existing plot or graphic.
#knitr::include_graphics("/Users/christophercrawford/Google_Drive/_Projects/Zambia/agroEcoTradeoff/external/plots/Estes-plots_test.png")

# Figure captions:
# https://bookdown.org/yihui/rmarkdown-cookbook/cross-ref.html

# manually write figure captions outside of chunk with the following
# (ref:caption-label) Figure caption text.

# Chunk options:
# include = FALSE - this means that the code will still be evaluated, but none of the output will be included in the resulting document.

# fig.cap = '(ref:caption-label)' in the chunk options

# cross reference in line with: \@ref(fig:chunk-label) (or eq:label, or tab:label)

# can also include a list of figures by including the following in the YAML
# lof: True
# or, as I currently have it.
# \listoffigures





# --------------------------------------------------
# PNAS Formatting
# --------------------------------------------------
# https://www.pnas.org/authors/submitting-your-manuscript
# PNAS direct submission articles are usually about 4000 words with 50 references and 4 figures (though there is some variation and flexibility). The format follows: Intro, Results (possibly with sections), Discussion, Materials & Methods, Acknowledgements, References (in order they are cited). Though submissions are “format neutral” at the start, it doesn’t seem too difficult to format to match this from the start. 
# Some recent relevant articles in PNAS: Rudel et al. 2009, Wright & Wimberly 2013, Norden et al. 2015, Lambin & Meyfroidt 2011, Griscom et al. 2017, Nerlekar & Veldman 2020.

```

```{r get-summary-stats, include = FALSE}
summary_stats_all_sites
extrapolate_df_l3


abn_duration_stats <- list(
  mean_duration = summary_stats_all_sites$mean_of_means %>% round(digits = 2),
  sd_duration = summary_stats_all_sites$mean_of_sds %>% round(digits = 2),
  
  extrapolation_low = extrapolate_df_l3 %>% select(site, max_mean_age) %>% unique() %>% arrange(max_mean_age) %>% .$max_mean_age %>% .[1] %>% round(digits = 1),
  extrapolation_high = extrapolate_df_l3 %>% select(site, max_mean_age) %>% unique() %>% arrange(max_mean_age) %>% .$max_mean_age %>% .[9] %>% round(digits = 1),
  
  duration_min = mean_length_df %>% 
    filter(abn_threshold == 5, length_type == "all") %>% 
    slice_min(mean_duration) %>% 
    select(mean_duration) %>% round(digits = 2),
  
  duration_min_site = mean_length_df %>% 
    filter(abn_threshold == 5, length_type == "all") %>% 
    slice_min(mean_duration) %>% .$site %>% capwords(),
  
  duration_max = mean_length_df %>% 
    filter(abn_threshold == 5, length_type == "all") %>% 
    slice_max(mean_duration) %>% 
    select(mean_duration) %>% round(digits = 2),
  
  duration_max_site = mean_length_df %>% 
    filter(abn_threshold == 5, length_type == "all") %>% 
    slice_max(mean_duration) %>% .$site %>% gsub("_", " & ",.) %>% capwords(),
  
  sd_min = mean_length_df %>% filter(abn_threshold == 5, length_type == "all") %>% slice_min(sd_duration) %>% select(sd_duration) %>% round(digits = 2),
  
  sd_min_site = mean_length_df %>% filter(abn_threshold == 5, length_type == "all") %>% slice_min(sd_duration) %>% .$site %>% capwords(),
  
  sd_max = mean_length_df %>% filter(abn_threshold == 5, length_type == "all") %>% slice_max(sd_duration) %>% select(sd_duration) %>% round(digits = 2),
  sd_max_site = mean_length_df %>% filter(abn_threshold == 5, length_type == "all") %>% slice_max(sd_duration) %>% .$site %>% gsub("_", " ",.) %>% capwords()
)

```


# Abstract
*Must be <250 words (currently 250)*

Agricultural expansion is a major cause of land-use change globally, but millions of hectares of cropland are simultaneously being abandoned as a result of demographic, economic, and environmental changes.
These abandoned croplands could be immensely valuable for carbon sequestration and biodiversity restoration.
However, their environmental value depends on the duration and persistence of abandonment, which is poorly known.
Here, we use high-resolution satellite imagery to examine the timing and duration of abandonment at eleven sites across four continents that experienced cropland abandonment from 1987 and 2017.
We find that abandonment is by and large fleeting, lasting on average only `r abn_duration_stats$mean_duration` years (SD = `r abn_duration_stats$sd_duration`).^[*Note: both values reported are the means of each site's corresponding summary statistics, i.e. the mean of means and mean of standard deviations*]
At most sites, more than 50% of abandoned croplands were projected to be recultivated within 25 years, and some sites, particularly in Eastern Europe, Russia, and the US, showed accelerating rates of recultivation, with abandonment periods growing shorter over time.
If current rates of abandonment and recultivation continue, the mean duration of abandonment at most sites will likely plateau between `r abn_duration_stats$extrapolation_low` and `r abn_duration_stats$extrapolation_high` years by about 2040.
Counter to optimistic assumptions, most abandonment is unlikely to be permanent and will produce little in the way of benefits for carbon or biodiversity as a result.
New policies and incentives will be needed to lengthen the period of abandonment so as to generate these and other benefits.
Until then, abandoned croplands will remain untapped opportunities.

## Significance Statement
*Must be <120 words (currently 124)*

Demographic, economic, and environmental changes often result in cropland abandonment. 
While sometimes seen as a threat to food security and cultural landscapes, abandonment is increasing billed as an opportunity for habitat restoration and carbon sequestration.
However, those environmental benefits largely depend on how long ecosystems have to regenerate and accumulate carbon and biodiversity following abandonment, which takes decades in many ecosystems.
Existing studies often rely on single snapshots in time to estimate abandonment, and ignore recultivation.
Using annual land-cover maps, we track abandonment and recultivation at eleven sites across four continents that have recently experienced abandonment.
Contrary to previous assumptions, abandonment is short-lived and frequently recultivated.
Until policymakers take steps to reduce recultivation and provide incentives for regeneration, abandonment will remain a missed opportunity.

## Keywords

# Introduction

Populations are in flux around the world, as people seek new economic opportunities in cities and flee changing environments and conflicts [@Sanderson2018].
Coupled with environmental degradation and changing agricultural technologies, this rural outmigration has contributed to a decline in the economic viability of some agricultural lands, resulting in a growing global trend of agricultural abandonment [@ReyBenayas2007; @Prishchepov2021].
Furthermore, in a world with increasing competition for land, these abandoned agricultural lands are highly sought after for diverse goals such as biofuel production [@Naess2021], carbon sequestration [@Griscom2017; @Chazdon2016a], or increased cultivation [@Meyfroidt2016].
To conservation scientists, these lands represent a potentially large source of new habitat for wildlife as vegetation regenerates [@Chazdon2020; @Xie2019; @Navarro2012].

Millions of hectares of agricultural lands have been abandoned over the last half century [@Li2017], but for how long and to what end is unclear.
Understanding agricultural abandonment and its potential environmental impacts requires not only detailed information on where and when abandonment takes place, but critically, what happens to croplands and pastures after they are abandoned.
In order for abandoned lands to yield environmental benefits, they must stay abandoned long enough for appreciable gains to be made in both biomass and the species that make up intact ecological communities, which can take decades or longer to approach the levels of intact reference ecosystems, with species recolonizing at different successional stages [@Cook-Patton2020; @Nerlekar2020; @Rozendaal2019; @Acevedo-Charry2019; @Gilroy2014; @Isbell2019; @Poorter2016].
As a result, information on the long-term persistence and outcomes of abandoned lands is critical to understand the potential for these areas to help mitigate the ongoing climate and biodiversity crises, and design appropriate policy responses.

Yet until recently, it has been difficult to gather detailed information on abandonment.
Many estimates of abandonment are inferred by aggregating coarse estimates of regional cultivation, such as from FAO data on cultivated areas [@Isbell2019; @Munroe2013]).
When derived from satellite imagery, abandonment is most frequently estimated by comparing land cover maps for two distinct points in time, and simply taking the difference in cultivated area (e.g. 1992 and 2015 in [@Naess2021]).
Annual land-cover time series are becoming more common, but are often limited to a short period of time (e.g. 2-12 years [@Alcantara2013; @Estel2015; @Lark2015]; but see @Dara2018), limiting their utility for understanding abandonment.
These approaches all lack the spatial and temporal detail needed to understand long-term outcomes for individual croplands, which is critical for understanding the environmental implications of abandonment [@Yin2020].
Importantly, by masking dynamic patterns of abandonment and recultivation, they may result in significant overestimates of abandonment. 

Recent advances in satellite imagery-based land-cover mapping have made it possible to produce maps of land cover with both high spatial resolution and temporal resolution, allowing us to ask questions about the timing and trajectories of agricultural abandonment and land cover change. 
Here, we utilize a new annual time-series of cropland abandonment [@Yin2020] derived from publicly available Landsat imagery (1987-2017) to investigate the duration and persistence of abandonment at eleven sites across four continents, including sites in Brazil, the US, Eastern Europe, Russia, the Middle East, and China (Figure \@ref(fig:site-locations)).

Previous analyses have primarily explored the age and persistence of secondary forests in the Neotropics by identifying regeneration via the signal of woody regrowth in satellite imagery, finding that forest regeneration is often short-lived [@Reid2018; @Nunes2020; @Smith2020; @Schwartz2020].
Half of secondary forests are recleared in as little as 5 to 8 years in the Brazilian Amazon [@Aguiar2016; @Chazdon2016a; @Nunes2020], and 20 years or less in southern Costa Rica [@Reid2018].
More generally, reforestation may be as much as ten times more likely to be recleared than to persist [@Schwartz2020].
Yet while well-suited to analyses of forest regrowth, approaches that rely on woody vegetation risk missing abandonment that is in earlier stages of regeneration or does not transition into woody vegetation, particularly in landscapes with non-forest habitats [@Yin2020].

In order to address this constraint, Yin et al. -@Yin2020 used a trajectory-based approach produced more accurate maps of cropland abandonment that did not rely on more easily detectable woody revegetation, which allow for a focus on abandonment itself, not only the regenerating forests that may or may not follow abandonment.
@Dara2018 provide to our knowledge the only other analysis of abandonment based on a time series of annual land cover maps, yet is limited to just one region (northern Kazakstan).
By leveraging this new dataset [@Yin2020], we are able to ask questions about patterns of persistence and the longevity of abandonment and regeneration over a broad range of environments and agricultural contexts.

We address three specific questions: How long does cropland abandonment last, on average, and how does this vary geographically? How quickly is land recultivated, as measured by individual recultivation (or "decay") rates, and how do these rates vary through time? Finally, if recultivation rates stay about the same, and a similar amount of land is newly abandoned each year, how can we expect the mean age of abandoned croplands to change in these landscapes into the future?

By making use of more accurate and finer resolution abandonment maps, covering a longer period and broader set of sites than previous studies, we provide the most detailed understanding of the timing and persistence of abandonment to date. 
We find that abandonment is rarely permanent, but rather a dynamic phenomenon that varies spatially and temporally.
These simple insights about the trajectories taken by abandoned croplands provide much needed context to broad statements about recent and future abandonment and the contribution that abandonment many make to habitat regeneration and biodiversity conservation [@Chazdon2020].
The bulk of abandoned land may be relatively short-lived, from the perspective of ecological succession or carbon sequestration, and unlikely to regenerate into valuable habitat on its own without active policies to protect this land and encourage regeneration.
Together, these results provide a better understanding of the temporal nature of cropland abandonment and its implications for the environment, and should inform the design of policies to manage abandoned lands moving forward.

# Results

```{r results-outline, include = FALSE}
# Overarching question: how durable is abandonment?
# 
# Main questions:
# 1. How long does abandonment last, on average? How does this vary geographically?
# 2. How quickly is land recultivated, as measured by "abandonment decay rates"?
    # a. How do they vary across sites? (i.e. What proportion of abandoned land remains abandoned long-term [e.g. >20 years])
    # b. How do these decay rates vary through time at each site?
# 3. Extrapolation: if decay rates stay about the same, and a similar amount of land is newly abandoned each year, how will mean abandonment durations change into the future?
# 
# ________________
# Results outline:
# Four pieces: 1) describing the abandonment we saw in terms of area, scale, land cover outcomes, and recultivation, 2) duration of abandonment, 3) decay rates, and 4) extrapolation. 
# 
# Basics - describe the abandonment we saw at our sites
# -	how much abandonment occurred, as a proportion of site area? (Total area abandoned (% of total site area), and range of area abandoned at each site.)
# -	When did abandonment take place? (Some took place early on in the time series, some later) (could include the figure with area abandoned))
# -	what land cover did that abandoned land end up in?
# -	about how much of that land was recultivated over the course of the time series? This then leads into statistics of duration... ->
# 
# *Abandonment Duration:
# -	mean duration across all sites (mean of means, with mean of standard deviations)
# -	range of mean durations at individual sites (minimum and maximum)
# -	range of all durations within individual sites - how wide was the variation?
# 
# *Decay rates:
# -	mean decay rates by site across all cohorts (Fig. ). 
# -	time to 50% recultivation, 100% recultivation, min and max by site.
# -	rate of changes through time.
# 
# *Extrapolation:
# -	mean abandonment duration at each site in the extrapolation, overall
# -	min and max mean duration, with sites
# -	Most of the sites have a mean duration of less than ~20 years, and plateau by about 2040. 
# -	even at Shaanxi, the site projected to see the most durable abandonment, we see that a relatively small amount of land will remain abandoned for longer than 50 years. 
```

```{r get-results-stats, include = FALSE}
# site_r$shaanxi$y2017
# test_area <- raster::area(site_r$shaanxi$y2017)
# plot(test_area)
# ncell(site_r$shaanxi$y2017)
# ncell(test_area)
# names(test_area) <- "area_km2"
# test_dt <- as.data.table.raster(stack(site_r$shaanxi$y2017, test_area))
# test_dt[,sum(area_km2 * 100), by = y2017]
# 1332.768 + 1021861.526 + 153480.420 + 246237.428+ 151124.082

site_df_w_size # note that this includes NA or 0 lc class cells, so is an overestimate. Use the site area from area_summary_df
area_summary_df %>% names
area_summary_df %>% select(site, area_abn_ha_2017, total_site_area_ha_2017, area_as_prop_site) %>% arrange(area_as_prop_site)

# ---------------------------------------------------------------------- #
# area abandoned statistics
area_abn_stats <- list(
  "min" = area_summary_df %>% filter(site != "mato_grosso") %>% slice_min(area_abn_ha_2017) %>% select(area_abn_ha_2017) %>% 
    # as.numeric() %>% 
    prettyNum(big.mark = ","),
  "min_site" = area_summary_df %>% filter(site != "mato_grosso") %>% slice_min(area_abn_ha_2017) %>% .$site %>% capwords(),
  
  "max" = area_summary_df %>% slice_max(area_abn_ha_2017) %>% select(area_abn_ha_2017) %>% round(digits = 0) %>% as.numeric() %>% prettyNum(big.mark = ","),
  "max_site" = area_summary_df %>% slice_max(area_abn_ha_2017) %>% .$site %>% capwords(),

  "mg" = area_summary_df %>% filter(site == "mato_grosso") %>% select(area_abn_ha_2017) %>% round(digits = 0) %>% as.numeric() %>% prettyNum(big.mark = ","),
  "mg_abn_as_percent" = area_summary_df %>% filter(site == "mato_grosso") %>% select(area_as_prop_site) %>% round(digits = 4) * 100,
  
  "total_area_Mha_all_sites" = round(area_summary_df$total_site_area_ha_2017 %>% sum() / 10^6 , digits = 2),
  "total_area_abn_Mha_all_sites" = round(area_summary_df$area_abn_ha_2017 %>% sum() / 10^6, digits = 2),
  "total_area_abn_as_percent" = round((area_summary_df$area_abn_ha_2017 %>% sum() / 10^6) / (area_summary_df$total_site_area_ha_2017 %>% sum() / 10^6), digits = 4) * 100,
  
  "min_area_as_prop_site" = area_summary_df %>% filter(site != "mato_grosso") %>% slice_min(area_as_prop_site) %>% select(area_as_prop_site) %>% round(digits = 4) * 100,
  "min_area_as_prop_site_site" =  area_summary_df %>% filter(site != "mato_grosso") %>% slice_min(area_as_prop_site) %>% .$site %>% capwords(),
  
  "max_area_as_prop_site" = area_summary_df %>% slice_max(area_as_prop_site) %>% select(area_as_prop_site) %>% round(digits = 4) * 100,
  "max_area_as_prop_site_site" = area_summary_df %>% slice_max(area_as_prop_site) %>% .$site %>% capwords()
)

# ---------------------------------------------------------------------- #
area_recult_threshold %>% filter(abn_threshold == 10) %>% select(site, proportion_recultivated) %>% arrange(proportion_recultivated)

# recultivation statistics
recult_stats <- list(
  "mean_thr_5" = area_recult_threshold %>% group_by(abn_threshold) %>% summarise(mean_proportion = mean(proportion_recultivated)) %>% 
    filter(abn_threshold == 5) %>% select(mean_proportion) %>% round(digits = 4) * 100,
  
  "mean_thr_7" = area_recult_threshold %>% group_by(abn_threshold) %>% summarise(mean_proportion = mean(proportion_recultivated)) %>% 
    filter(abn_threshold == 7) %>% select(mean_proportion) %>% round(digits = 4) * 100,
  
  "mean_thr_10" = area_recult_threshold %>% group_by(abn_threshold) %>% summarise(mean_proportion = mean(proportion_recultivated)) %>% 
    filter(abn_threshold == 10) %>% select(mean_proportion) %>% round(digits = 4) * 100,
  
  "min_5" = area_recult_threshold %>% filter(abn_threshold == 5) %>% slice_min(proportion_recultivated) %>% .$proportion_recultivated %>% round(digits = 4) * 100,
  "min_5_site" = area_recult_threshold %>% filter(abn_threshold == 5) %>% slice_min(proportion_recultivated) %>% .$site %>% capwords(),
  
  "max_5" = area_recult_threshold %>% filter(abn_threshold == 5, site != "mato_grosso") %>% slice_max(proportion_recultivated) %>% .$proportion_recultivated %>% round(digits = 4) * 100,
  "max_5_site" = area_recult_threshold %>% filter(abn_threshold == 5, site != "mato_grosso") %>% slice_max(proportion_recultivated) %>% .$site %>% capwords(),
  
  "min_10" = area_recult_threshold %>% filter(abn_threshold == 10) %>% slice_min(proportion_recultivated) %>% .$proportion_recultivated %>% round(digits = 4) * 100,
  "min_10_site" = area_recult_threshold %>% filter(abn_threshold == 10) %>% slice_min(proportion_recultivated) %>% .$site %>% capwords(),
  
  "max_10" = area_recult_threshold %>% filter(abn_threshold == 10, site != "mato_grosso") %>% slice_max(proportion_recultivated) %>% .$proportion_recultivated %>% round(digits = 4) * 100,
  "max_10_site" = area_recult_threshold %>% filter(abn_threshold == 10, site != "mato_grosso") %>% slice_max(proportion_recultivated) %>% .$site %>% capwords()
)

abn_duration_stats # see "get-summary-stats"

# ---------------------------------------------------------------------- #
# land cover stats --------------------- #
lc_stats <- list(
  forest_min = abn_prop_lc_2017 %>% 
    filter(lc_2017 == 2) %>% slice_min(prop_lc) %>% 
    select(prop_lc) %>% round(digits = 2) * 100,
  
  forest_min_grassland = (1 - abn_prop_lc_2017 %>% 
                     filter(lc_2017 == 2) %>% slice_min(prop_lc) %>% 
                     select(prop_lc) %>% round(digits = 2)) * 100,
  
  forest_min_site = abn_prop_lc_2017 %>% 
    filter(lc_2017 == 2) %>% slice_min(prop_lc) %>% .$site %>% capwords(),
  
  forest_max = abn_prop_lc_2017 %>% 
    filter(lc_2017 == 2) %>% slice_max(prop_lc) %>% 
    select(prop_lc) %>% round(digits = 2) * 100,
  
  forest_max_grassland = (1 - abn_prop_lc_2017 %>% 
                         filter(lc_2017 == 2) %>% slice_max(prop_lc) %>% 
                         select(prop_lc) %>% round(digits = 2)) * 100,
  
  forest_max_site = abn_prop_lc_2017 %>% filter(lc_2017 == 2) %>% slice_max(prop_lc) %>% .$site %>% capwords()
  )

# ---------------------------------------------------------------------- #
# decay model stats:
time_to_0.5 <- time_to_l3 %>% filter(p == 0.5) %>%
  select(site, time_to_value, proportion, p) %>% arrange(time_to_value)

time_to_0 <- time_to_l3 %>% filter(p == 0) %>%
  select(site, time_to_value, proportion, p) %>% arrange(time_to_value)

t0.5_max_temp <- time_to_0.5 %>%
  slice_max(time_to_value, n = 3) %>% slice_min(time_to_value)

t0.5_min_temp <- time_to_0.5 %>% slice_min(time_to_value)

t0_max_temp <- time_to_0 %>%
  slice_max(time_to_value, n = 3) %>% slice_min(time_to_value)

t0_min_temp <- time_to_0 %>% slice_min(time_to_value)

decay_stats <- list(
  
  "t0.5_max" = t0.5_max_temp %>% select(time_to_value) %>% round(., digits = 2),
  "t0.5_max_site" = t0.5_max_temp %>% .$site %>% gsub("_", " ",.) %>% capwords(),
  
  "t0.5_min" = t0.5_min_temp %>% select(time_to_value) %>% round(., digits = 2),
  "t0.5_min_site" = t0.5_min_temp %>% .$site %>% gsub("_", " ",.) %>% capwords(),
  
  "t0_max" = t0_max_temp %>% select(time_to_value) %>% round(., digits = 2),
  "t0_max_site" = t0_max_temp %>% .$site %>% gsub("_", " ",.) %>% capwords(),
  
  "t0_min" = t0_min_temp %>% select(time_to_value) %>% round(., digits = 2),
  "t0_min_site" = t0_min_temp %>% .$site %>% gsub("_", " ",.) %>% capwords(),
  
  "shaanxi_0.5" = time_to_l3 %>% filter(p == 0.5, site == "shaanxi") %>% select(time_to_value) %>% round(., digits = 2),
  "shaanxi_0" = time_to_l3 %>% filter(p == 0, site == "shaanxi") %>% select(time_to_value) %>% round(., digits = 2),
  
  "mg_0.5" = time_to_l3 %>% filter(p == 0.5, site == "mato_grosso") %>% select(time_to_value) %>% round(., digits = 2),
  "mg_0" = time_to_l3 %>% filter(p == 0, site == "mato_grosso") %>% select(time_to_value) %>% round(., digits = 2),
  
  "percent_at_20_min" = fitted_df_l3 %>% filter(age == 20) %>% arrange(fitted) %>% slice_min(fitted) %>% .$fitted %>% round(digits = 4) * 100,
  "percent_at_20_min_site" = fitted_df_l3 %>% filter(age == 20) %>% arrange(fitted) %>% slice_min(fitted) %>% .$site %>% capwords(),
  "percent_at_20_max" = fitted_df_l3 %>% filter(age == 20) %>% arrange(fitted) %>% slice_max(fitted) %>% .$fitted %>% round(digits = 4) * 100,
  "percent_at_20_max_site" = fitted_df_l3 %>% filter(age == 20) %>% arrange(fitted) %>% slice_max(fitted) %>% .$site %>% capwords()
)

# ---------------------------------------------------------------------- #
# extrapolation stats:
plateau_times <- extrapolate_df_l3 %>% 
    group_by(site) %>% slice_max(., mean_age, with_ties = FALSE) %>%
    arrange(mean_age) %>% 
    ungroup() %>% mutate(time = year - 1987)

extrap_prop <- 
  future_df_l3 %>% mutate(
  age_bin = cut(age, breaks = seq(from = 0, to = 140, by = 15), right = TRUE)) %>%
  filter(year == 2120) %>% 
  group_by(site) %>%
  summarise(total_abn_in_2120 = sum(exp_area_ha)) %>% 
  left_join(., 
            future_df_l3 %>% mutate(
              age_bin = cut(age, breaks = seq(from = 0, to = 140, by = 15), right = TRUE)) %>%
              filter(year == 2120, age > 30) %>% 
              group_by(site) %>%
              summarise(over_30 = sum(exp_area_ha)),
            by = "site") %>%
  mutate(prop_over_30 = 100 * over_30/total_abn_in_2120) %>%
  left_join(., 
            future_df_l3 %>% mutate(
              age_bin = cut(age, breaks = seq(from = 0, to = 140, by = 15), right = TRUE)) %>%
              filter(year == 2120, age > 50) %>% 
              group_by(site) %>%
              summarise(over_50 = sum(exp_area_ha)),
            by = "site") %>%
  mutate(prop_over_50 = 100 * over_50/total_abn_in_2120)

extrapolation_stats <- list(
  "plateau_min" = plateau_times %>% slice_min(mean_age) %>% .$mean_age %>% round(digits = 2),
  "plateau_min_year" = plateau_times %>% slice_min(mean_age) %>% .$year,
  "plateau_min_time" = plateau_times %>% slice_min(mean_age) %>% .$time,
  "plateau_min_site" = plateau_times %>% slice_min(mean_age) %>% .$site %>% capwords(),
  
  "plateau_max" = plateau_times %>% slice_max(mean_age) %>% .$mean_age %>% round(digits = 2),
  "plateau_max_year" = plateau_times %>% slice_max(mean_age) %>% .$year,
  "plateau_max_time" = plateau_times %>% slice_max(mean_age, n = 3) %>% slice_min(mean_age) %>% .$time,
  "plateau_max_site" = plateau_times %>% slice_max(mean_age) %>% .$site %>% capwords(),
  
  # proportions over 30
  "prop_over_30_upper_range" = extrap_prop %>% arrange(desc(prop_over_30)) %>% filter(!site %in% c("shaanxi", "mato_grosso")) %>% slice_max(prop_over_30) %>% .$prop_over_30 %>% round(digits = 0),
  
  "prop_over_30_upper_range_site" = extrap_prop %>% arrange(desc(prop_over_30)) %>% filter(!site %in% c("shaanxi", "mato_grosso")) %>% slice_max(prop_over_30) %>% .$site %>% capwords(),
  
   "prop_over_50_shaanxi" = extrap_prop %>% filter(site == "shaanxi") %>% .$prop_over_50 %>% round(digits = 0)
)


# extrapolate_df_l3$year %>% max()
# 
# extrapolate_df_l3 %>% filter(year == 2150)
# 
# gg_extrapolation_panel_age_b +
#   scale_x_continuous(breaks = seq(from = 2000, to = 2120, by = 40)) +
#   geom_vline(xintercept = 2008)
```

(ref:caption-site-locations) Site locations with observed abandonment duration (in years) as of 2017.

```{r site-locations, fig.cap = '(ref:caption-site-locations)', echo=FALSE}
knitr::include_graphics(path = paste0(p_plots, run_label, "/site_locations_w_abn_age_rev", run_label,".pdf"))
```

We find substantial amounts of cropland abandonment, observing a total of `r area_abn_stats$total_area_abn_Mha_all_sites` million ha (Mha) of abandoned croplands as of 2017 across our eleven sites (`r area_abn_stats$total_area_abn_as_percent`% of the `r area_abn_stats$total_area_Mha_all_sites` Mha total land area across sites).
Cropland abandonment at individual sites ranged between `r area_abn_stats$min` ha (`r area_abn_stats$min_site`) and `r area_abn_stats$max` ha (`r area_abn_stats$max_site`) as of 2017 (Figure \@ref(fig:area-abn-by-age-class)), and because our sites varied in size, this corresponded to between `r area_abn_stats$min_area_as_prop_site`% (`r area_abn_stats$min_area_as_prop_site_site`) and `r area_abn_stats$max_area_as_prop_site`% (`r area_abn_stats$max_area_as_prop_site_site`) of the total area of each site (Figure \@ref(fig:area-abn-panel)).
The notable exception was Mato Grosso (Brazil), which saw only `r area_abn_stats$mg` ha of abandonment (`r area_abn_stats$mg_abn_as_percent`% of total site area) as of 2017.

The timing of abandonment varied across sites (Figure \@ref(fig:area-abn-by-age-class)), with some sites showing more abandonment earlier in the time series followed by a gradual leveling off (e.g. Iraq, Bosnia & Herzegovina, Volgograd, Nebraska, & Mato Grosso), some showing consistent abandonment over time (e.g. Eastern Belarus/Smolensk, Russia; Goiás, Brazil; and Wisconsin), and others showing abandonment increasing in the latter half of the time series (e.g. sites in Shaanxi/Shanxi and Chongqing Provinces, China).
The site locations, along with the age of abandoned croplands in years, as of 2017, is shown in Figure \@ref(fig:site-locations).

Abandoned cropland followed different successional trajectories at each site, where the proportion of abandoned cropland distributed between forest and grassland (as of 2017) ranged from a minimum of `r lc_stats$forest_min`% in forest (`r lc_stats$forest_min_grassland`% in grassland) at `r lc_stats$forest_min_site` to a maximum of `r lc_stats$forest_max`% in forest (`r lc_stats$forest_max_grassland`% in grassland) at `r lc_stats$forest_max_site` (see Figure \@ref(fig:abn-prop-lc); cumulative changes in land cover through time are shown for each site in Figure \@ref(fig:area-by-lc)).

## Abandonment duration

However, we also find that many of these abandoned croplands were recultivated during our time series (on average, `r recult_stats$mean_thr_5`% of abandoned area across all sites; Figure \@ref(fig:recult-by-threshold)).
As a result, the mean duration of abandonment across all sites was short: `r abn_duration_stats$mean_duration` years (SD = `r abn_duration_stats$sd_duration`), with a minimum site mean duration of `r abn_duration_stats$duration_min` years (`r abn_duration_stats$duration_min_site`) and a maximum of `r abn_duration_stats$duration_max` years (`r abn_duration_stats$duration_max_site`; see Figure \@ref(fig:mean-abn-duration)).
Abandonment duration varied within sites, with individual site standard deviations ranging between `r abn_duration_stats$sd_min` (`r abn_duration_stats$sd_min_site`) and `r abn_duration_stats$sd_max` years (`r abn_duration_stats$sd_max_site`).

(ref:caption-mean-abn-duration) Mean length of time abandoned (years) throughout our time series across study sites. The mean abandonment duration is calculated across all periods of abandonment (a single pixel may go through multiple periods of abandonment; in red) and across the longest period of abandonment for each pixel throughout the time series (maximum length; in blue).

```{r mean-abn-duration, fig.cap = '(ref:caption-mean-abn-duration)', echo=FALSE}
# (ref:caption-mean-abn-duration) Sites included in this study, from @Yin2020.
# cite inline using the following  \@ref(fig:mean-abn-duration)

knitr::include_graphics(path = paste0(p_plots, run_label, "/mean_lengths", run_label, ".pdf"))
```

(ref:caption-area-abn-by-age-class) Cumulative area abandoned at each site through time, according to age class (in years).

```{r area-abn-by-age-class, fig.cap = '(ref:caption-area-abn-by-age-class)'}
knitr::include_graphics(path = paste0(p_plots, run_label, "/abn_area_by_age_grid", run_label, ".pdf"))
```

## Modeling persistence, decay, & recultivation

We tracked groups (i.e. "cohorts") of croplands that were abandoned in a given year, modeling the proportion of each cohort remaining abandoned as a function of time since initial abandonment (see Section \@ref(methods), Figure \@ref(fig:abn-decay-s)).
By doing so, we are able to predict how long a given abandoned cropland will persist before it is recultivated, regardless of when it was abandoned during the time series.
This also allows us to calculate the mean recultivation (or "decay") trajectory at each site (Figure \@ref(fig:decay-curves-by-site)).

Recultivation takes place relatively quickly at most of our sites: >50% of abandoned croplands are recultivated within 25 years at almost all sites, with the time required for 50% recultivation ranging between `r decay_stats$t0.5_min` (`r decay_stats$t0.5_min_site`) and `r decay_stats$t0.5_max` years (`r decay_stats$t0.5_max_site`).
The primary exception was our site in Shaanxi/Shanxi Provinces (China), which showed more durable abandonment, requiring `r decay_stats$shaanxi_0.5` years to decline by half, and `r decay_stats$shaanxi_0` years for complete turnover.
Mato Grosso also showed relatively more durable abandonment, requiring `r decay_stats$mg_0.5` years to decline by half and `r decay_stats$mg_0` years for complete turnover. 
However, because Mato Grosso showed large amounts of new cultivation over the source of our time series and relatively little abandonment (`r area_abn_stats$mg` ha), these results should be interpreted with care.

These mean decay trajectories also show wide variation in the proportion of abandoned croplands that persist beyond 20 years: as few as `r decay_stats$percent_at_20_min`% of abandoned croplands remained abandoned more than 20 years at `r decay_stats$percent_at_20_min_site`, up to `r decay_stats$percent_at_20_max`% at `r decay_stats$percent_at_20_max_site`.
As Figure \@ref(fig:decay-curves-by-site) shows, many sites show 50% recultivation between 20-30 years.

(ref:caption-decay-curves-by-site) Mean decay trajectories for each site, based on the mean coefficients across all cohorts of abandoned land.

```{r decay-curves-by-site, fig.cap = '(ref:caption-decay-curves-by-site)', echo=FALSE}
# switch to wide (full time span) vs. just the first 50 years
# show_wide <- TRUE
# knitr::include_graphics(path = paste0(p_plots, run_label, "/decay/model_decay_curves_by_site_l3", ifelse(show_wide, "_wide", ""), run_label, ".png"))

knitr::include_graphics(path = paste0(p_plots, run_label, "/decay", "/mean_decay_curves", run_label, ".pdf"))
```

By modeling recultivation for each cohort of abandonment, we are also able to investigate whether recultivation is accelerating at each site.
Most sites showed a negative trend in the time required for recultivation, indicating that abandoned croplands were being recultivated more quickly throughout the time series (Figure \@ref(fig:decay-rate-of-change)).
A simple linear regression on the time required for half of each cohort of abandoned cropland to be recultivated revealed that just over half of our sites shows rates of change that were negative and significantly different from zero: Bosnia & Herzegovina, Volgograd, Wisconsin, Nebraska, Orenburg, and Iraq (Figure \@ref(fig:decay-rate-of-change)).
The remaining sites showed trends that were not significantly different from zero.

```{r old-roc-text, include = FALSE}
# [*Update based on ultimate choice of model*]
# However, a simple linear regression on the time required for half of each cohort of abandoned cropland to be recultivated revealed that most sites did not have a slope significantly different from zero (Figure \@ref(fig:decay-rate-of-change)).
# The lone exception was our site in Bosnia & Herzegovina, where croplands abandoned later in the time series were recultivated significantly more quickly.
```

## Extrapolation

If decay rates remain about the same at each site, and a similar and constant area of cropland is newly abandoned each year, a simple extrapolation indicates that the impermanence we observe is not merely an artifact of the narrow window of our time series.
Extrapolating out multiple decades, we expect the mean duration of abandonment to plateau at 20 years or less at most sites (Figure \@ref(fig:extrapolation-combo)), with the notable exception of Shaanxi, which is projected to plateau at a mean duration of `r extrapolation_stats$plateau_max` years. 
The time it takes to plateau is depends on the time it takes for complete turnover, ranging between `r extrapolation_stats$plateau_min_time`-`r extrapolation_stats$plateau_max_time` years for all sites except Mato Grosso (`r decay_stats$mg_0` years) and Shaanxi (`r decay_stats$shaanxi_0` years).

Looking at the age distribution of abandoned croplands in our extrapolation (Figure \@ref(fig:extrapolation-area-by-age)), we see that at most sites, only a relatively small proportion remains abandoned beyond 30 years (less than `r extrapolation_stats$prop_over_30_upper_range`% at most sites).
Even at Shaanxi, the site projected to see the most durable abandonment, we see that only `r extrapolation_stats$prop_over_50_shaanxi`% of land will remain abandoned for longer than 50 years.

# Discussion

```{r disc-outline}
# Basic outline:
# -	What do these results mean? Contrary to optimistic assumptions, we find that abandonment is not likely to be a permanent phenomenon.
# -	Placing results in the context of other recent studies of area and potential of abandonment (lean on recent Nature Sustainability paper).
# -	Link results to biodiversity and carbon benefits – how long does it take for carbon and biodiversity benefits to accrue in these parts of the world?
# -	Highlight methodological advancements
# -	Mention the sensitivity analysis we conducted on thresholds of abandonment
# -	Policies that could be used to share the future of abandoned croplands.
# -	End by reiterating the missed opportunity and placing a call to action. 
```

Using our new high spatial and temporal resolution annual time series of land cover, we are able to uncover significant amounts of abandonment, constituting more than 12% of the total land area across our eleven sites.
However, we also uncover significant levels of recultivation within our time series, observing that on average, 37% of abandoned croplands were recultivated by 2017, resulting in a relatively short mean abandonment duration of around 15 years.
There is a wide range of variation across sites, with some sites showing accelerating rates of recultivation, yet even the sites with the most durable abandonment are unlikely to see large amounts of land persist for longer than 50 years.
Our modeled decay rates portray a more dynamic process, where abandonment is infrequently an endpoint but rather part of a cycle involving turnover on time scales rarely longer than decades [@Munroe2013].

Contrary to optimistic assumptions, abandonment is unlikely to be a permanent phenomenon.
Estimates of abandonment based on short time series or two points in time (e.g. the 83 Mha of abandoned cropland estimated by @Naess2021) likely significantly overestimate the amount of durable abandonment, on the order of 20-45% or more. 
This may dramatically limit the scope for abandonment to play a role in carbon sequestration or the regeneration of biodiversity.

Our results also include a range of interesting temporal patterns of abandonment. 
For example, Belarus & Herzegoniva displays a strong bifurcated pattern, where some abandonment remains relatively durable and long-lasting, while other abandonment is recultivated relatively quickly. 
This could be a function of sociopolitical upheaval in Eastern Europe and Russia in the early 1990s.
It could also simply be a function of time: the longer a field is abandoned, the less likely it is to be recultivated (as observed by [@Dara2018]). 
This could stem from patterns of agricultural viability. 
If the least viable lands are abandoned first, then it would make sense for the most recently abandoned land to also be the most attractive areas for recultivation.
Another possibility is that younger abandoned fields are simply easier to reclear, due to less woody regrowth (as farmers have indicated they prefer [@Prishchepov2021a]). 
The fact that our highest performing model of recultivation included two time terms (linear and logarithmic) supports the idea that time may influence recultivation through multiple mechanisms.

Our analysis makes a few specific methodological advancements. 
By using annual land cover maps rather than two snapshots in time, we provide a more accurate understanding of the persistence of abandonment.
Furthermore, by tracking cohorts of abandoned croplands based on the year of abandonment, we are able to model the speed of recultivation regardless of when abandonment took place during the time series.
For example, while Shaanxi has among the shortest observed duration of abandonment, current recultivation trajectories indicate that abandonment is likely to be more durable than we are able to observe during the time series.
We are also able to then use the recultivation rates we calculated for each cohort to observe where recultivation is happening more quickly: Bosnia & Herzegovina, which had the longest abandonment durations observed during our time series, was also shown to be experiencing faster recultivation towards the end of the time series.  
Finally, we are able to use these recultivation rates to perform simply exploratory extrapolations of our results beyond the time series, helping us understand the implications of such turnover.

## Our results in context

There is little information on the variation of agricultural fallow periods around the world [@Chazdon2016a], but the abandonment and impermanence that we observe is in line with that observed in other studies.
The only other study [@Dara2018] using an annual time series to investigate agricultural abandonment (in a grassland region of northern Kazakhstan between 1991-2017), observed abandonment of about 40% of cultivated areas, and the subsequent recultivation of about 20% of those abandoned lands.
This value, while in line with our most durable site (Shaanxi), was lower than both the average across sites (`r recult_stats$mean_thr5`%), and the recultivation seen at our sites closest to Kazakhstan, Orenburg and Volgograd, Russia, which saw recultivation of `r area_recult_threshold %>% filter(abn_threshold == 5, site == "orenburg") %>% .$proportion_recultivated %>% round(digits = 4) * 100`% and `r area_recult_threshold %>% filter(abn_threshold == 5, site == "volgograd") %>% .$proportion_recultivated %>% round(digits = 4) * 100`% respectively (Figure \@ref(fig:recult-by-threshold)).

Our projected time required for 50% of abandoned croplands to be recultivated was in the same range as that observed in some studies (e.g. 20 years, @Reid2018), but slightly longer than that observed elsewhere in the Neotropics [@Chazdon2016a; @Nunes2020; @Smith2020].
Compared to the 12 to 24 year half lives we saw at most of our sites, secondary forests were recleared even more quickly in the Brazilian Amazon (5 to 8 years), resulting in around 80% of secondary forests less than 20 years old, and around 40% less than 5 years old as of 2017 [@Chazdon2016a; @Nunes2020; @Smith2020].
However, this difference may be the result of a time delay between abandonment and the detection of woody vegetation regrowth in these studies, our exclusion of abandonment less than five years, or our method of modeling recultivation for each cohort individually in order to reduce the influence of the time series length.

## Implications for biodiversity and carbon sequestration

For environmental scientists and advocates hoping that regenerating habitats in abandoned croplands will provide refuge for biodiversity while also sequestering carbon, the short-lived abandonment and frequent recultivation we observe here stands to significantly limit the potential for these benefits to accrue.
There is significant uncertainty about how quickly and how completely ecosystems recover through ecological succession following disturbances and abandonment [@Norden2015; @Crouzeilles2016; @Arroyo-Rodriguez2017].
Yet, evidence suggests that natural regeneration can be a viable ecosystem restoration strategy under the right conditions (e.g. after relatively lighter disturbances, and when in landscapes containing relatively high amounts of intact ecosystems), resulting in secondary growth that can approach the habitat and carbon values of reference intact ecosystems and provide a range of ecosystem services [@Crouzeilles2019; @Gilroy2014; @Arroyo-Rodriguez2017].
Encouragingly, natural regeneration also has the potential to be cheaper and more successful than active restoration under the right conditions, though it may take longer following crop cultivation, and active approaches are required in more heavily altered systems [@Crouzeilles2017; @Gilroy2014; @Meli2017].

However, even with the right conditions at the local and landscape scales, recovery requires time.
Though some aspects of ecosystems recover more quickly than others (along with the species associated with those elements), in most cases, it takes multiple decades to recover species richness to values close to those in reference systems. 
Critically, the speed and degree to which biodiversity recovers during succession also depends on the metric being used to assess these changes through time [@Crouzeilles2016].
Quick recovery of species richness or abundance may be overly optimistic, given that patterns of abundance and diversity can be dominated by widespread, disturbance-adapted, and habitat generalist species [@Crouzeilles2016; @Rydgren2020].
Rarer, forest-adapted, and old-growth dependent species return more slowly, and measures that better capture the recovery towards old-growth ecosystems, such as community composition, species similarity, and vegetation structure, can take much longer to recover [@Meli2017; @Arroyo-Rodriguez2017].

Some ecosystems and biomes seem to recover more quickly and successfully than others, namely in higher rather than lower latitudes, colder rather than warm climates, and in humid rather than arid biomes [@Prach2018].
Our sites cover a range of biomes, including Temperate Broadleaf and Mixed Forests (Belarus/Smolensk, Bosnia & Herzegovina, Wisconsin), Temperate Grasslands, Savannas, and Shrublands (Nebraska, Orenburg, Volgograd), and Tropical Grassland (Goiás, Mato Grosso) and Tropical Moist Broadleaf Forests (Chongqing, Mato Grosso) (Figure \@ref(fig:site-biomes)).
Shaanxi/Shanxi and Iraq were dominated by Montane Grassland and Shrublands and Deserts & Xeric Shrublands, respectively.
Land cover outcomes for abandoned croplands by the end of the time series showed wide variation across sites, with most abandonment classified as forest in Wisconsin, but mostly grassland everywhere else (Figure \@ref(fig:abn-prop-lc)).
Most sites see little woody vegetation growth, though this may be a result of the biome or simply not having enough time for woody biomass to develop.

Tropical ecosystems are among the most diverse in the world, but in some cases can recovery quite quickly through regeneration, though not on a time scale as short as the abandonment we observe here.
In a study of regeneration on abandoned agricultural land in the Colombian Andes, @Gilroy2014 show that bird and dung beetle communities were very similar to those in primary reference forests after 15-30 years, but saw incomplete recovery before that.
Yet, other studies point to longer recovery times. 
Neotropical chronosequences show that lowland tropical forests recover quickly in terms of tree species richness (reaching 80% of old-growth levels after 20 years, 90% after 31 years), but slowly in terms of tree species composition (34% of old-growth levels after 20 years, and requiring 487 years to reach 90%) [@Rozendaal2019].
However, there was significant variation among sites, and because forest cover was quite high at these sites (76% on average), recovery is likely to be slower in less forested ecosystems [@Rozendaal2019].

A recent meta-analysis of tropical forests found that while amphibian, bird, mammal, and reptile species richness largely recovered during regeneration, reaching similar richness levels after about 40 years, the recovery of species compositional similarity took much longer (if at all), particularly for later successional species and forest specialists [@Acevedo-Charry2019].
None of the vertebrate groups returned to community compositions that were similar to reference old-growth forests, even in the oldest secondary forests (30-65 years). 
This finding, along with the fact that some groups such as forest-specialists and insectivores took longer to recover richness levels, indicate that species richness metrics overestimate the speed and success of recovery of biodiversity through secondary succession [@Acevedo-Charry2019].
These patterns are not only constrained to plant and vertebrate species: a global meta-analysis revealed that soil conditions also recovered incompletely in restored agricultural lands, even after 50 years [@Parkhurst2021].

Some evidence indicates that grassland ecosystems recover more quickly following disturbances than forests [@Jones2009], but amidst a growing appreciation for the high biodiversity value of old-growth grasslands, recent studies have highlighted the long recovery times for secondary grasslands. 
@Nerlekar2020 show that on average, secondary grasslands contained only 53-76% of the plant species richness of old-growth grasslands, and even after full recovery of species richness (with minimum recovery times of >100 years), compositional similarity to old-growth grasslands would remain low (43%).
Similarly, @Isbell2019 showed that despite relatively quick gains in biodiversity following abandonment (averaging over 1/3 diversity after just one year of succession), both biodiversity and productivity grow more slowly over time, only reaching 73% of the diversity and 53% of the productivity levels of a reference ecosystem after 91 years.
In Eurasian grasslands, which have experienced widespread abandonment, plant communities had not fully recovered to reference levels after 24 years, in terms of both species richness and community composition [@Kampf2016], and differed substantially from reference systems [@Brinkert2016].
Similar patterns exist for vertebrate species as well: while bird species richness and diversity was higher in older abandoned fields (5-18 years) than in recently abandoned fields (<4 years), they remained lower than the reference ungrazed steppe grasslands [@Kamp2011].

### Carbon

Regenerating habitats may also only achieve a small fraction of their carbon storage potential if they last only a few decades. 
While carbon accumulates quite quickly over the first few decades of regeneration, it can take between 50-100 years to achieve similar levels of biomass as old-growth forests [@Poorter2016; @Martin2013]. 
A study of Neotropical biomass recovery showed that forests were able to recover 90% of the biomass of old-growth forests after a median of 66 years, yet were typically at <50% of the biomass after 20 years.
But like biodiversity, carbon accumulation estimates vary by biome and by prior land use. 
Former croplands showed the fastest carbon accumulation rates in temperate broadleaf forests (~3.2 Mg C per ha per year), but only intermediate rates relative to other land uses in tropical moist forests (~1.75 Mg C per ha per year).
Based on estimates of potential carbon accumulation rates during the first 30 years of natural regeneration across biomes developed by @Cook-Patton2020, we would expect the abandoned croplands we observe to accumulate between 30-70 Mg C per ha over 20 years.
Relative to the 110-250 Mg C per ha total that could be accumulated over 100 years, this represents only 18%-45% of the potential sequestration after 100 years [@Cook-Patton2020].

Given that much of the abandonment we observe occurred in grassy biomes, it is important to note that soil carbon sequestration could play a large role in addition to carbon sequestration in woody biomass.
But like aboveground biomass in trees, soil carbon may accumulate slowly, taking up to a century (or possibly longer) to return to reference levels [@Yang2019].
Encouragingly, however, the restoration of late-successional grassland species can result in fast soil carbon sequestration, particularly a decade or two after abandonment [@Yang2019].

```{r, include = FALSE}
# Estimates for total carbon accumulation over time from Cook-Patton et al. 2020 (Nature, "Mapping carbon accumulation potential from global natural forest regrowth"), based on the best fit lines in Figure 1:
# https://www.nature.com/articles/s41586-020-2686-x#Fig1

cook_patton <- tibble(
  biome = c("Boreal", "Temperate conifer", "Temperate broadleaf", 
            "Subtropical and tropical dry", "Subtropical and tropical savanna", 
            "Subtropical and tropical moist"),
  year20 = c(30, 25, 30, 50, 35, 70), # estimates based on visual interpretation of Fig. 1
  year100 = c(70, 170, 165, 110, 170, 250), # estimates based on visual interpretation of Fig. 1
  units = c("Mg C per ha")
) %>% mutate(percent = year20/year100 * 100)

cook_patton 

# average carbon accumulation rate from Cook-Patton et al. 2020, across all biomes.
3.16 * 20

3.2 * 20
1.75 * 20

```

```{r, include = FALSE}
lennox <- tibble(
  group = c("large‐stemmed plants","small‐stemmed plants", "birds", "dung beetles"),
  richness = c(0.016, 0.026, 0.026, 0.036),
  composition = c(0.014, 0.021, 0.024, 0.034)
)

lennox %>% mutate(rich20 = 20*richness,
                  comp20 = 20*composition)

1.2 * .20 # biomass
```

### Additional challenges to regeneration

Impermanence is not the only potential challenge to regeneration in abandoned croplands.
The effects of soil degradation, a lack of nearby source populations for both plant and animal species, a lack of natural disturbance regimes (particularly in grassland ecosystems), and climate change, all pose challenges for regeneration.
The natural regeneration of grassland ecosystems face particular challenges, in that many grasslands require the maintenance of a natural disturbance regime (e.g. grazing or fire), which are often nonexistent in areas experiencing abandonment [@Nerlekar2020].
Some ecologists highlight the potential loss of grassland biodiversity if low-intensity farmlands (often having been cultivated at a low intensities for centuries) are abandoned and replaced by woody vegetation in the absence of natural disturbance regimes, particularly in historically unforested ecosystems [@Wright2012; @Queiroz2014; @Nerlekar2020].
While this presents an inevitable trade-off as some species gain and others lose habitat [@Sirami2008], in some cases, approaches that aim to restore disturbance regimes and a mix of habitats might result in better conservation outcomes, depending on the species and ecosystems of conservation concern [@ReyBenayas2007].

Though cropland is likely on the more disturbed end of the spectrum, it is likely that some abandoned croplands are more likely to regenerate successfully, due to the proportion of intact vegetation in the surrounding landscape, or fundamental qualities of the biome.
Future research should assess the extent to which abandonment is taking place in landscapes with conditions that tend to favor natural regeneration.

## Defining abandonment

A few additional factors deserve consideration.
First, abandonment is likely to be more common in our sites than across the globe in general, given that we explicitly chose sites that have seen large amounts of recent abandonment.
Second, and more consequentially, we recognize that while we use a five year abandonment definition (following FAO), the length of fallow periods may vary widely around the world, and many studies use different definitions of abandonment. 
While distinguishing the recultivation of abandoned land from long fallow periods remains a challenge, it is possible that longer fallow periods would be more appropriate in certain contexts.
We tested the influence our definition has our results, and found that, as expected, longer definitions resulted in longer average abandonment durations, less abandonment over all (Figure \@ref(fig:abn-thresholds-mean-duration)), and lower recultivation rates (\@ref(fig:recult-by-threshold)). 
However, even when only considering abandonment of longer than 10 years, we saw observed the recultivation of between `r recult_stats$min_10`% and `r recult_stats$max_10`% recultivation at (`r recult_stats$min_10_site`) and (`r recult_stats$max_10_site`) respectively, enough to significantly impact regeneration and the associated benefits.

## Conclusions

As we have shown, cropland abandonment is unlikely to be permanent in many places around the world that have experienced recent abandonment.
Without the development of careful policies and concerted efforts to protect these croplands, they are unlikely to provide significant biodiversity and carbon benefits on their own. 
Our results reinforce growing calls for enhanced monitoring of regeneration [@Cook-Patton2021], and the development of stronger policy framework for managing these lands.

In addition to the biophysical challenges outlined above, there are a range of socioeconomic and political barriers to habitat regeneration in abandoned croplands.
These include a lack of recognition of secondary habitats and their values, policies that obligate farmers to cultivate land, a lack of incentives to protect and foster regenerating habitats, and perhaps most importantly, negative cultural perceptions of "abandonment" and the "messy" landscapes that result [@Chazdon2020].
Agricultural abandonment is a result of broader changes to landscapes, communities, and ways of life, which can present difficult cultural challenges.
Recent behavioral research on farmer decisions to recultivate abandoned lands has highlighted the importance of sociopolitical factors such as corruption, political and institutional support for agriculture, and demographics alongside biophysical and environmental conditions [@Prishchepov2021a].

In order for abandoned croplands to provide environmental benefits through habitat regeneration or carbon sequestration, they must persist for longer. 
This could involve either incorporating abandoned fields in protected areas, incorporating natural regeneration into ecosystem service schemes to allow landowners to benefit alongside the environment, or taking steps to reduce turnover among fields that have previously been part of long-term fallowing cycles. 
The relative durability of abandonment at our Chinese sites point to the potential influence of large-scale reforestation programs implemented over the last 20 years. 
New policies could also involve supporting long-term cultivation of some lands, while protecting (“sparing”) those that had previously been part of long-term fallowing cycles.
These policies should developed alongside local communities in order to best manage the trade-offs between biodiversity, carbon storage, and livelihoods.

Our results make one thing clear: if cropland abandonment continues to be as short-lived as we shown here, the negative socioeconomic consequences of abandonment will continue to dominate, and the large potential benefits of regenerating habitats to both store carbon and sustain biodiversity will remain an untapped opportunity.

# Materials and Methods {#methods}

```{r methods-outline, include = FALSE}
# ## Outline
# 
# - Definitions of abandonment
# - Describe abandonment map data
#     - statement about R versions
# - Data processing & filtering steps
#     - important filtering steps include a) removing non-abandonment pixels, and b) passing a temporal filter to remove instances of recultivation that last only 1 year.
#     - tracking abandonment trajectories
# - Modeling abandonment decay
#     - why/motivation
#     - modeling approach, diagnostic steps, etc. mostly pointing towards the SI
#     - translating the decay models into a modified prediction of mean length abandoned
# - Spatial predictors
#     - what factors are investigated
#     - modeling approach, short paragraph
# - R packages used that we didn't already specifically mention
# 
# 
# This is the code used for data processing, and should be a good reference for remembering what I did. Probably a good idea to narratively write down what I did in the code, and which SLURM scripts I used, even if just to put in one of the .Rmd analysis documents. 
# ~/Google_Drive/_Projects/abandonment_trajectories/scripts/cluster/analyze_all_sites.R
```

## Abandonment maps

We build on annual land cover maps for 1987-2017 developed by @Yin2020.
These maps, derived from publicly available Landsat satellite imagery (30 m resolution), mapped pixels to four land cover classes: 1) cropland, 2) herbaceous vegetation (e.g. grassland), 3) woody vegetation (e.g. forests), and 4) non-vegetation (e.g. water, urban, or barren land).
We selected 11 sites that were mapped with high accuracy [*ask He for stat to insert here*] and provide broad coverage of different continents and ecosystems (see Figure \@ref(fig:site-locations)).
@Yin2020 selected sites that were likely to have recently experienced agricultural abandonment, due to socioeconomic, political, or environmental reasons.
Thus, our results accurately represent those areas that have recently experienced abandonment, but likely overestimate the overall prevalence of abandonment across all agricultural regions.

## Defining abandonment

Differentiating "true" abandonment from less permanent land-use changes, such as short-term fallowing or crop rotations, is difficult because definitions can vary widely by region and by study.
In fact, abandonment is best viewed as a land-use transition in which land may pass through a spectrum of stages [@Munroe2013].
Here, we define "abandonment" as agricultural land that is no longer under active cultivation and is left free of direct human influence, therefore excluding shifts to less intensive uses such as extensive grazing.
In order to exclude short-term fallow periods, we define croplands as abandoned when they remain uncultivated for five or more consecutive years (following FAO 2016, or 2021, http://www.fao.org/faostat/en/#definitions; we explore the impact of changing this threshold in SI Section \@ref(abn-thresholds)).
We focus exclusively on cropland abandonment, excluding the abandonment of pastures, which is more difficult to discern from satellite imagery (though recent advances have been made; [*add Yin study on grassland abandonment, other citations*]) and is not captured into our data.

## Data processing and filtering

We processed and analyzed our abandonment map data in RStudio version `r rstudioapi::versionInfo()$version` [-@RStudio], using `r R.Version()$version.string`, relying heavily on the `raster` [@R-raster], `data.table` [@R-data.table], and `tidyverse` [@R-tidyverse] packages.

We identified periods of cropland abandonment by tracking each pixel's land cover classification through time and looking for land-cover changes that indicated transitions between agricultural activity and abandonment.
Taking a conservative approach, we considered "agricultural activity" to include both stable cultivation (continuous classification as cropland) and cyclical fallowing (one or more years of cropland followed by fewer than five years of non-cropland).
We classified a pixel as "abandoned" when it transitioned from cropland to either herbaceous or woody vegetation (collectively referred to as "non-cropland"), and subsequently remained classified as non-cropland for five or more consecutive years (following FAO, as above). 
This transition from cropland to abandonment could take place at any point during the time-series, allowing for the abandonment of both long-term or newly converted croplands.
We considered an abandoned pixel to be "recultivated" when it transitioned from abandoned to cropland.
Pixels that transitioned from cropland to the non-vegetation class were not considered "abandoned," and therefore we excluded all non-vegetation pixels from our analysis.*^[These pixels represent a very small portion of our dataset, and non-vegetated land remained about constant or declined over time at most sites.]*

We implemented five- and eight-year moving window temporal filters to smooth land cover trajectories in our time series and address land-cover changes that are temporally unlikely (see SI Section \@ref(methods-si)).
Together with our five-year abandonment threshold, these temporal filters have the ultimate effect of minimizing the effect of very short-term misclassifications that could otherwise look like recultivation.

## Calculating abandonment duration

We calculate abandonment duration as the number of years that elapse between the initial transition from cropland to non-cropland and either recultivation or the end of the time series.
Our abandonment definition implies a minimum abandonment duration of five years.
Because a pixel may go through multiple periods of abandonment (being abandoned and recultivated multiple times throughout the time series), we calculate the mean abandonment duration in two ways: 1) across all distinct periods of abandonment, and 2) across only the longest period of abandonment for each pixel (“maximum abandonment length”) (Figure \@ref(fig:mean-abn-duration)).

## Modeling abandonment decay

The mean abandonment duration tells us about the general persistence of abandoned croplands throughout the time series. 
However, this value is limited by the time series length, and does not account for when the majority of the abandonment took place at a site, nor whether a period of abandonment ends as a results of recultivation or the end of the time series.
As a result, the mean abandonment duration does not tell us how long to expect a piece of land to remain abandoned, nor how abandonment length varies through time.

To address this constraint, we track the trajectory of each pixel through time following its initial abandonment, grouping pixels abandoned in a given year into "cohorts."
For each group ("cohort"), we track recultivation ("decay") by calculating the proportion of each cohort that remains abandoned through time, relative to when that land was first classified as abandoned.

We then ran linear models (using the `stats::lm()` function in R's core statistics package), predicting the proportion of abandoned cropland in each cohort remaining abandoned as a function of time since initial abandonment.
We tested a range of  model specifications, including linear and log transformations of both *proportion* and *time*.
Importantly, we also include *cohort* fixed effects, allowing for the estimation of unique coefficients for each cohort of abandoned land.
These modeled decay trajectories are shown for one example site, Shaanxi/Shanxi Provinces, China, in Figure \@ref(fig:abn-decay-s).

Due to a linear relationship between model residuals and time when including only one term for *time*, we also tested models containing multiple *time* predictor terms, including both log and linear terms.
We selected the highest performing model based on Akaike Information Criterion values (AIC; Figure \@ref(fig:AIC)).
For cohorts of abandonment initially abandoned in years $y = 1988 ... 2013$, our model predicted the proportion $p$ of each cohort $y$ remaining abandoned as a function of time $t$ (i.e. the number of years following initial abandonment), with one log-transformed and one linear term of time (Equation \@ref(eq:mod-spec)).

\begin{equation}
p_{y} = 1 + \beta_{1,y} log(t + 1) + \beta_{2,y} t (\#eq:mod-spec)
\end{equation}

Where $\beta_{1,y}$ represents the regression coefficient on the log term of time $t$ for cohort $y$, and $\beta_{2,y}$ represents the regression coefficient on the linear term of time $t$ for cohort $y$.
We allow for site and cohort level fixed effects, fitting unique coefficients for each cohort at each site.
This corresponds to a `lm()` call of `lm(formula = I(proportion - 1)  ~ 0 + log(time + 1):cohort:site + I(time):cohort:site)`

Model coefficients are shown in Figure \@ref(fig:decay-mod-coef).
Model assumptions were tested through visual inspection of diagnostic plots (Figures \@ref(fig:diag-resid-fitted) and \@ref(fig:diag-qq); full details are contained in Section \@ref(mod-AIC-diag)).
We calculate each site's mean recultivation trend by taking the mean of the model coefficients across all cohorts (Figure \@ref(fig:mean-abn-duration)).

Importantly, this approach also allows us to look at changes in persistence over time, and whether recultivation is accelerating or decelerating.
Based on the modeled recultivation trajectory of each cohort, we calculate the time required for half of a given cohort to be recultivated. 
We then ran a simple linear model on this value on each cohort at each site to uncover temporal changes in recultivation patterns (See Section \@ref(section-methods-rate-of-change)).
Trends were considered statistically significant when the 95% confidence interval for model coefficients (slopes) did not include zero. 
See full results in Figure \@ref(fig:decay-rate-of-change).

(ref:caption-abn-decay-s) Decay of abandoned land at a single site, Shaanxi/Shanxi Provinces, China. This shows the proportion of each cohort of abandoned land (i.e. land abandoned in a given year) that remains abandoned over time. This shows the relative speed at which land is recultivated, through time. Green points represent observations, green lines represent model results for each individual cohort, and the solid blue line represents the mean trend across all cohorts (averaging across cohorts for each coefficient). All sites are shown together in Figure \@ref(fig:decay-model-grid), and larger individual model results are shown in Figures \@ref(fig:decay-model-indiv-site-b)-\@ref(fig:decay-model-indiv-site-w).

```{r abn-decay-s, fig.cap = '(ref:caption-abn-decay-s)', echo=FALSE}
# knitr::include_graphics(path = paste0(p_plots, run_label, "persistence_proportion", run_label, "_s.png"))
knitr::include_graphics(path = paste0(p_plots, run_label, "/decay/ms_fig_l3_cohort", run_label, "_s.png"))
```

### Extrapolation

Based on our modeled decay rates, we extrapolate abandonment and recultivation into the future, asking: if abandonment and recultivation rates stay about the same, how much abandoned land will accumulate, and how long will it last on average?

We make two simple assumptions:  
First, that a constant amount of cropland is newly abandoned each year, based on the mean area of cropland abandoned each year at each site (the "Area Gained" in Figure \@ref(fig:turnover-grid)). 
Second, that all abandoned croplands at a given site are recultivated at the same rate, as determined by the mean trend for that site.
The mean trend, calculated as the mean of the model coefficients across all years of abandonment, is shown in Figure \@ref(fig:decay-curves-by-site).

These results are shown in Figure \@ref(fig:extrapolation-combo), along with a more detailed breakdown in Figure \@ref(fig:extrapolation-area-by-age), which shows the age of abandoned lands by age class. 
(*TBD, Tentative expectation:*) We considered a range of alternatives to these two assumptions, as detailed in Section \@ref(section-extrapolation-si), but found these general pattern to hold. 
If anything, our initial assumptions yield a more optimistic picture of how average duration of abandonment will change into the future.

# Data Availability Statement

Code to replicate these analyses is available on GitHub at [https://github.com/chriscra/abandonment_trajectories](https://github.com/chriscra/abandonment_trajectories), and a static archive can be found at [zenodo (TBD)](https://doi.org/). *Question for He: do you intend to make these data public?*

# Acknowledgements

We thank the following researchers at the University of Wisconsin-Madison, whose land cover maps made this analysis possible: Amintas Brandão, Johanna Buchner, David Helmers, Benjamin G. Iuliano, Niwaeli E. Kimambo, Katarzyna E. Lewińska, Elena Razenkova, Afag Rizayeva, Natalia Rogova, Seth A. Spawn, & Yanhua Xie.
We are deeply indebted to Alex Wiebe, whose statistical advice informed and significantly improved our models of abandonment decay and recultivation.
We also thank the Drongos research group for invaluable advice and companionship.
This work was supported by the High Meadows Foundation and performed using Princeton Research Computing resources at Princeton University, a consortium of groups led by the Princeton Institute for Computational Science and Engineering (PICSciE) and Office of Information Technology's Research Computing.

# Supporting Information 

A version of this manuscript that includes the Supporting Information [can be found here](https://drive.google.com/file/d/1Y_tnucb_Zia-4qE4-vc02s5hFuMHnIZ9/view?usp=sharing).

\newpage
# References

::: {#refs}
:::

\newpage

<!-- \beginsupplement -->

# Supporting Information

```{r figures-outline}
# Main Text Figures:
# 1.	Site locations with maps showing duration of abandonment as of 2017 at each site (*)
# 2.	Mean abandonment duration (all periods, max duration) (*)
# 3.	Area abandoned by age class over time – facet grid, all sites (*)
# a.	possible addition is to add the area abn as a proportion of the site areas to this figure – if time. 
# 4.	Mean decay curve at each site, wide (showing descent from 1 to 0). 
# 5.	Example decay curves with raw data as points, modeled decay trajectories, and mean trajectory – for one site, Shaanxi (as example). In methods section
# 
# SI -----------------------
# 6.	Site locations – plain
# 7.	Area abandoned summary panel: as of 2017, ever, as proportion of total site area, as proportion of cropland area (SI)
# a.	Perhaps better to have just the total area abandoned as of 2017, and as a proportion of site area
# 8.	Land cover outcomes for abandoned croplands as of 2017
# 
# Extended results
# 9.	Area by land cover class, over time – facet grid, all sites (SI)
# 10.	Turnover in abandoned area - facet grid, all sites (SI) 
# 
# Decay
# 11.	Facet grid of decay plots for each site, with model trajectories and mean decay rates
# b.	Alternatively, large decay plot for each site. (currently commented out)
# 12.	Log and linear model coefficients for decay models, by site (vertical two panel plot) (SI)
# 13.	Model AIC comparison plot (SI)
# 14.	Model diagnostic plots (SI) – fitted values vs. residuals.
# 15.	Decay rate - rate of change coefficients – combination of four quadrant plot showing the change in the “time to half” over the course of the time series, together with the coefficient on the right. (SI)
# 
# Extrapolation
# 16.	Extrapolation figure, showing the average abandonment duration over time (and perhaps the area abandoned through time, too) (two panel) (MS)
# 17.	Extrapolation of area abandoned by age classes – facet grid with all sites. (SI)
# 
# Thresholds of abandonment:
# 18.	Abandonment threshold – effect on mean abandonment duration (SI)
# 19.	Abandonment threshold – effect on amounts of recultivation (SI)
# 
# Maps
# 20.	Maps of abandonment duration as of 2017 at each site (levelplots showing distribution on axes, with histogram) (SI)
# 21.	Maps of maximum abandonment duration (levelplots showing distribution on axes, with histogram) (SI)
# 22.	Abandonment duration in 2017 - all sites (SI)
# 23.	Max abandonment duration – all sites
# 
# Extended Results:
# 24.	(x11) Panel grids for each site, including the four summary plots, with histograms of the distribution of abandonment lengths (all periods and max length).
# c.	Example panel grid for Shaanxi, showing a) area abandoned by age class, b) area by land cover class, c) turnover (with or without modelled trajectories), and d) decay. (not necessary, won’t fit)

```

## Extended Methods {#methods-si}

We calculated area using the `raster::area()` function.

### Classifying abandonment
Pixels that remained in cropland or non-cropland classes throughout the entire time series were excluded, as were periods of non-cropland that began in the first year of the time series, even if that pixel was later classified as cropland and subsequently abandoned (leaving only periods of abandonment that we could verify had followed agricultural activity during our time series).

As noted, pixels that transitioned from cropland to the non-vegetation class were not considered "abandoned," and therefore we excluded all non-vegetation pixels from our analysis.
These pixels represent a very small portion of our dataset, and non-vegetated land remained about constant or declined over time at most sites.
See Figure \@ref(fig:area-by-lc).

Restricting the mean abandonment duration to account for only those pixels that are both abandoned and recultivated within the time series would exclude a large portion of our data, and may underestimate the eventual lengths of many periods of abandonment that begin close to the end of our time series.
(Note: assessing temporal changes in mean length abandoned would involve looking at the mean length of time abandoned at each year of Figure \@ref(fig:abn-panel-s)a).


### Temporal filters {#temporal-filters}

In order to address potential classification errors in a single year, we implemented a series of temporal filters intended to smooth the trajectories in our time series by looking for short-term land-cover changes that are temporally unlikely.
We applied five-year and eight-year moving window filters designed to search for short periods of land cover classifications that do not match those immediately before and after, and subsequently update them to match the surrounding classifications.
Specifically, the five-year filter searched for one year periods that did not match the two years immediately before and after (i.e. patterns of 11011, where 1 represents non-cropland and 0 represents cropland), and our eight-year filter searched for two year periods that did not match the three years before and after (i.e. 11100111). 
The central classifications were then updated to match the classes on either end.
We also considered applying modified versions of these moving window filters to the start of the time series, but decided against it, for the sake of consistency and parsimony.

```{r unused-edge-filter-text, include = FALSE, eval = FALSE}
# To be more conservative about the identification of abandonment, we also applied modified versions of these five- and eight-year moving window filters to the start of the times series. 
# By conservatively assuming the years immediately prior to our time series to be classified as non-cropland, we are able to use our moving window filters to exclude additional cases where a one or two year period of cropland may not represent stable cultivation (e.g. reading from left to right, starting in 1987: 011, 1011, 00111, 100111, and 1100111). 
# Non-cropland periods that follow potentially misclassified cropland would more accurately reflect a continuation of existing non-cropland, rather than cropland abandonment.
# 
# This has the effect of applying a three-year threshold on the number of consecutive years of cropland required at the start of the time series in order to confidently signify agricultural activity that could be subsequently abandoned.^[Where 1 represents non-cropland and 0 represents cropland:  
# 87__88__89__90__91__92__93__94  
# 0___1___1___1___1___1___1___1 - caught by edge filter (011)  
# 0___0___1___1___1___1___1___1 - caught by edge filter (00111)  
# 0___0___0___1___1___1___1___1 - Age count starts in '90, classified as abandoned in '94
# ]
# 
# Collectively, these filters mean that the first year a piece of land could be abandoned is 1990, as long as it remains consecutively uncultivated at least through 1994.
# These edge patterns were uncommon, however, with the edge filtering at the beginning of the time series affecting fewer than 7% of pixels at each site. *^[Should this be relative to all pixels, or those that experience some abandonment?]* See Figure 
# 
# No special actions were taken on the end of the time series, with the possible effect of including erroneous recultivation at the end of the time series, making our estimates of the length of time abandoned conservative (i.e. shorter). 
# We decided to only address the edge cases at the start of the time series because we prefer to be conservative by excluding lands that may be consistently noncrop lands from our estimate of abandonment.
# In contrast, edge cases at the end of the time series only affect our estimate of the length of time abandoned, because one or two year periods of cropland, if misclassified, may erroneously mark recultivation in the final years of the time series.
# However, we decline to address any potential misclassifications at the end of the time series in order to take the more conservative approach with regards to recultivation.

knitr::include_graphics(path = paste0(p_plots, run_label, "/temp_filter_counts_plot_full.png"))
```

### Tracking abandonment trajectories

In order to track the persistence of individual ...

This will involve the code in `cc_summarize_abn_dts()` and `cc_calc_persistence()`.
Write a simple sentence describing what we did here.



### Decay models

#### Motivation

Decay rates provide information about how long it takes for land to be recultivated, complementing the mean abandonment length and providing a more nuanced story about how long to expect abandonment to last. 

For example, a site may have a relatively short mean length of abandonment (e.g. Shaanxi/Shanxi Province, with a mean abandonment length of 13 years; see Figure \@ref(fig:site-locations)), but also have a gradual decay rate, indicating that land should stay abandoned for a relatively longer amount of time. 
This may result from more abandonment occurring towards the end of the time series; this land simply does not have as long to age and shows up as younger in our data, regardless of how long it may last.

Looking at abandonment decay rates for each cohort individually allows us to produce a decay rate for each site in general in a way that accounts for when during the time series a piece of land was abandoned (i.e. giving us a sense of how long to expect a given piece of land to remain abandoned, even into the future).

(Note: the following three sentences may be redundant.)
For example, imagine two fields, one abandoned in 1990 and the other abandoned in 2010.
They may both end up remaining abandoned for 15 years, but the second field will show up as having an age of 7 at the end of our time series (which ends in 2017), regardless of how long it lasts.
One way we could deal with this is to only look at land that was affirmatively recultivated; another is to look at decay rates for each cohort, over time.

## Extended results

### Site locations

(ref:caption-site-locations-plain) Site locations, from @Yin2020.

```{r site-locations-plain, fig.cap = '(ref:caption-site-locations-plain)', echo=FALSE}
# just plain site locations
knitr::include_graphics(path = paste0(p_plots, "site_locations_w_labels_long.png"))
```


(ref:caption-site-biomes) Site biomes, using biome classifications from The Nature Conservancy's Terrestrial Ecoregions of The World (TEOW) database, derived from @Olson2001 and @Olson2002.

```{r site-biomes, fig.cap = '(ref:caption-site-biomes)', echo=FALSE}
# just plain site locations
knitr::include_graphics(path = paste0(p_plots, "biomes_by_site.pdf"))
```


### Area of each site

The area abandoned at each site is shown in Figure \@ref(fig:area-abn-panel). 
Area by land cover class is shown for each site in Figure \@ref(fig:area-by-lc), and the area abandoned is shared by age class in Figure \@ref(fig:area-abn-by-age-class). 

(ref:caption-area-abn-panel) Area abandoned a) as of 2017, b) at any point between 1987-2017, c) as a proportion of the total site area, and d) as a proportion of the total cropland area in 1987. Note that sites are shown in ascending order of area as a proportion of total site area.

```{r area-abn-panel, fig.cap = '(ref:caption-area-abn-panel)'}
knitr::include_graphics(path = paste0(p_plots, run_label, "/area_abn_panel", run_label, ".pdf"))
```

We also find that a significant area of abandoned croplands were recultivated by the end of our time series (Figure \@ref(fig:abn-prop-lc)).

(ref:caption-abn-prop-lc) Proportion of abandoned cropland in each land cover class as of 2017.

```{r abn-prop-lc, fig.cap = '(ref:caption-abn-prop-lc)', echo=FALSE}
knitr::include_graphics(path = paste0(p_plots, run_label, "/abn_prop_lc_2017", run_label, ".pdf"))
```

(ref:caption-area-by-lc) Area in each land cover class at each site through time. Land cover classes are cropland, grassland, woody vegetation, non-vegetation, and abandoned (for at least 5 years).

```{r area-by-lc, fig.cap = '(ref:caption-area-by-lc)'}
knitr::include_graphics(path = paste0(p_plots, run_label, "/area_by_lc_grid", run_label, ".pdf"))
```

(ref:caption-turnover-grid) Annual turnover of abandoned croplands at each site, showing the annual gain (dark green) and loss (i.e. recultivation, light green) of abandoned croplands. The black line shows the annual net change.

```{r turnover-grid, fig.cap = '(ref:caption-turnover-grid)'}
knitr::include_graphics(path = paste0(p_plots, run_label, "/turnover_grid", run_label, ".pdf"))
```


### The effect of varying abandonment definitions {#abn-thresholds}

- Abandonment threshold, including a higher threshold (something like 6 or 10 years), along with how thresholds change total pixels/area.


```{r, include = FALSE}

mean_length_df %>% filter(length_type == "all") %>% arrange(site)

overall_means <- mean_length_df %>%
  group_by(abn_threshold, length_type) %>%
  summarise(overall_mean = mean(mean_duration, na.rm = TRUE)) %>% ungroup()


threshold_stats <- list(
  one = overall_means %>% filter(abn_threshold == 1, length_type == "all") %>% .$overall_mean %>% round(digits = 0),
  three = overall_means %>% filter(abn_threshold == 3, length_type == "all") %>% .$overall_mean %>% round(digits = 0),
  five = overall_means %>% filter(abn_threshold == 5, length_type == "all") %>% .$overall_mean %>% round(digits = 0),
  ten = overall_means %>% filter(abn_threshold == 10, length_type == "all") %>% .$overall_mean %>% round(digits = 0)
)
```

A relatively short-term definition of abandonment might result in an overestimation of recultivation, because short term abandonment may be better understood as cyclical fallow periods, not true abandonment. 
Because fallow periods may vary around the world, we tested multiple abandonment thresholds, and mean abandonment duration across our sites increased accordingly, ranging between `r threshold_stats$one` (no threshold) and `r threshold_stats$ten` (10 years) years.
The proportion of abandoned croplands that were recultivated by the end of the time series also responded to our abandonment threshold, but even at the longest abandonment definition (10 years), we still saw that between 10 and 30% of abandoned croplands were recultivated by the end of the time series.
This indicates that the abandonment and recultivation we observe is not merely a function of our five year abandonment definition.

(ref:caption-abn-thresholds-mean-duration) Mean abandonment lengths shown for various abandonment thresholds.

```{r abn-thresholds-mean-duration, fig.cap = '(ref:caption-abn-thresholds-mean-duration)'}
knitr::include_graphics(path = paste0(p_output, "plots/", run_label, "/mean_lengths_by_threshold", run_label, ".png"))
```

Like the mean duration of abandonment, the amount of recultivation depends on our definition of abandonment (Figure \@ref(fig:recult-by-threshold)). We find that the mean area of abandoned croplands that get recultivated by the end of the time series declines from `r recult_stats$mean_thr_5`% with a 5 year threshold to `r recult_stats$mean_thr_7`% with a 7 year threshold, and `r recult_stats$mean_thr_10`% with a 10 year threshold. 

(ref:caption-recult-by-threshold) Recultivation rates shown for various abandonment thresholds.

```{r recult-by-threshold, fig.cap = '(ref:caption-recult-by-threshold)'}
knitr::include_graphics(path = paste0(p_output, "plots/", run_label, "/recultivation_rates_by_threshold", run_label, ".pdf"))
```


### Maps

Note: may not be necessary, since they will be the focus of Chapter 4. 

Can also include maps for each site of both a) abandonment *age in 2017* (e.g. Figure \@ref(fig:map-abn-age-2017-s)) and b) *max age* (e.g. Figure \@ref(fig:map-abn-age-max-s)) for all sites.

See function `cc_age_levelplot_hist()` to produce these side by side, with site name in the title

(ref:caption-map-abn-age-2017-s) Duration of abandonment (in years) as of 2017, `r site_df$description[9]`.

```{r map-abn-age-2017-s, fig.cap = '(ref:caption-map-abn-age-2017-s)'}
knitr::include_graphics(path = paste0(p_plots, run_label, "/spatial_reg/age_duration_2017_w_dist", run_label, site_df$label[9], ".pdf"))
```

(ref:caption-map-abn-age-max-s) Maximum duration of abandonment (in years), `r site_df$description[9]`.

```{r map-abn-age-max-s, fig.cap = '(ref:caption-map-abn-age-max-s)'}
knitr::include_graphics(path = paste0(p_plots, run_label, "/spatial_reg/age_duration_max_w_dist", run_label, site_df$label[9], ".pdf"))
```

(ref:caption-map-abn-age-2017) Duration of cropland abandonment (in years) as of 2017 at our 11 sites.

```{r map-abn-age-2017, fig.cap = '(ref:caption-map-abn-age-2017)'}
knitr::include_graphics(path = paste0(p_plots, run_label, "/abn_age_maps_2017_rev", run_label, ".pdf"))
```

(ref:caption-map-abn-age-max) Maximum duration of cropland abandonment (in years) at each pixel between 1987-2017.

```{r map-abn-age-max, fig.cap = '(ref:caption-map-abn-age-max)'}
knitr::include_graphics(path = paste0(p_plots, run_label, "/abn_age_maps_max_rev", run_label, ".pdf"))
```

### Summary composite figures

(ref:caption-abn-panel-s) Abandonment at a single site (Shaanxi/Shanxi Provinces, China), showing a) accumulation of abandoned land by age class, b) decay of abandoned land by year abandoned, c) the area in each land cover class through time (including both land that has been abandoned for five or more years, as well as any land abandoned for 1 or more years, therefore including short-term fallows), and d) the annual turnover of abandoned land through time. Corresponding results for our other sites are shown in Figures \@ref(fig:panel-b)-\@ref(fig:panel-w).

```{r abn-panel-s, fig.cap = '(ref:caption-abn-panel-s)', echo=FALSE}
# note: this the results panel figure of just Shaanxi province, as an example I had previously intended to have in the main text.
knitr::include_graphics(path = paste0(p_plots, run_label, "/ms_panel", run_label, "_s.png"))
```

\newpage

## Decay models

(ref:caption-decay-model-grid) Decay model results for all sites, showing raw data (green points) and modeled abandonment trajectories for individual years (green lines). The mean decay trajectory for the site is calculated as the mean of the coefficients for each cohort (solid blue line). Larger model results are shown in Figures \@ref(fig:decay-model-indiv-site-b)-\@ref(fig:decay-model-indiv-site-w).

```{r decay-model-grid, fig.cap = '(ref:caption-decay-model-grid)', echo = FALSE}
knitr::include_graphics(path = paste0(p_plots, run_label, "/decay/", "decay_mod_grid", run_label, ".pdf"))
```

Model results:

- Decay rate rate of change for each site, in four quadrants, with linear regression coefficients (Figure \@ref(fig:decay-rate-of-change))
- Projected proportions remaining after set periods of time (10 years, 20 years, 30 years, etc.)
- Decay curves with model fitted values for each site. (Figure \@ref(fig:decay-rate-of-change), and individual models )
- an alternative representation of the mean decay rate (Figure \@ref(fig:decay-time-to-range))


(ref:caption-decay-mod-coef) Mean decay model coefficients across cohorts at each site. The left panel shows the mean coefficient on the log(time) terms and the right shows the site mean coefficient on the linear time terms. These mean coefficients are used to plot the mean decay trajectories shown in Figure \@ref(fig:decay-curves-by-site).

```{r decay-mod-coef, fig.cap = '(ref:caption-decay-mod-coef)', echo = FALSE}
knitr::include_graphics(
  path = paste0(p_plots, run_label, "/decay/", "l3_cohort_coefs_by_site", run_label, ".png")
  )
```

### Model selection and diagnostics {#mod-AIC-diag}

We chose a model with the following specifications shown in Equation \@ref(eq:mod-spec-SI).
For cohorts of abandonment initially abandoned in years $y = 1988 ... 2013$, we estimate the proportion $p$ of each cohort $y$ remaining abandoned as a function of time $t$ (i.e. based on the number of years after initial abandonment).

\begin{equation}
p_{y} = 1 + \beta_{1,y} log(t + 1) + \beta_{2,y} t (\#eq:mod-spec-SI)
\end{equation}

Where $\beta_{1,y}$ represents the regression coefficient on the log term of time $t$ for cohort $y$, and $\beta_{2,y}$ represents the regression coefficient on the linear term of time $t$ for cohort $y$.
We allow for site and cohort level fixed effects, fitting unique coefficients for each cohort at each site.

This corresponds to a `lm()` call of `lm(formula = I(proportion - 1)  ~ 0 + log(time + 1):cohort:site + I(time):cohort:site)`

Model selection was done based on Akaike Information Criterion (AIC) values (Figure \@ref(fig:AIC)).
We checked linear model assumptions through visual inspection of both residuals vs. fitted plots (Figure \@ref(fig:diag-resid-fitted)) and Q-Q plots (Figure \@ref(fig:diag-qq)).
See also Figure \@ref(fig:diag-combo) to see diagnostic plots for the full model, including all sites.

(ref:caption-AIC) Akaike Information Criterion (AIC) values for various model specifications for each site. More negative AIC values indicate a better model fit.

```{r AIC, fig.cap = '(ref:caption-AIC)', fig.width = 7.5}
knitr::include_graphics(path = paste0(p_plots, run_label, "/decay/", "mod_AIC_plot", run_label, ".pdf"))
```

(ref:caption-diag-resid-fitted) Residuals vs. fitted diagnostic plots for each site.

```{r diag-resid-fitted, fig.cap = '(ref:caption-diag-resid-fitted)'}
knitr::include_graphics(path = paste0(p_plots, run_label, "/decay/", "l3_cohort_diag_resid_v_fitted", run_label, ".png"))
```

(ref:caption-diag-qq) QQ plots for each site, calculated using the `car` package (@R-car).

```{r diag-qq, fig.cap = '(ref:caption-diag-qq)'}
knitr::include_graphics(path = paste0(p_plots, run_label, "/decay/", "l3_cohort_diag_qq_subset", run_label, ".png"))
```

<!-- Possibly remove -->
(ref:caption-AIC-mega) Akaike Information Criterion (AIC) values for various model specifications, calculated for models including all sites together. More negative AIC values indicate a better model fit.

```{r AIC-mega, fig.cap = '(ref:caption-AIC-mega)', fig.width = 7.5}
knitr::include_graphics(path = paste0(p_plots, run_label, "/decay/", "mod_AIC_mega_plot", run_label, ".png"))
```

<!-- Possibly remove -->
(ref:caption-diag-combo) Diagnostic plots for all sites together.

```{r diag-combo, fig.cap = '(ref:caption-diag-combo)'}
knitr::include_graphics(path = paste0(p_plots, run_label, "/decay/", "l3_cohort_diag_combo", run_label, ".png"))
```

\newpage

### Rate of change {#section-methods-rate-of-change}

We examined the rate of change of recultivation rates by calculating the time required for 50% of each cohort to be recultivated and running a simple linear regression on these values as a function of time. 
We estimate the time required for half (50%) of a given cohort of abandoned cropland to be recultivated, $t_{half,s}$, as a function of the year of initial abandonment ($yearabn_{s}$), at each site $s$.
This model is shown in Equation \@ref(eq:rate-of-change-lm).

\begin{equation}
t_{half,s} = \beta_{0,s} + \beta_{1,s} yearabn_{s} (\#eq:rate-of-change-lm)
\end{equation}

Where $\beta_{1,s}$ represents the regression slope on the year abandoned for site $s$ ($yearabn_{s}$), and $\beta_{0,s}$ represents the intercept.
This corresponds to a `lm()` call of `lm(formula = t_half ~ year_abandoned)` run for each site individually.
Results are shown in Figure \@ref(fig:decay-rate-of-change).

We confirmed that model assumptions were met through visual inspection of residuals vs. fitted plots (Figure \@ref(fig:rate-of-change-diag-resid-fitted)) and Q-Q plots (Figure \@ref(fig:rate-of-change-diag-qq)).

(ref:caption-decay-rate-of-change) The rate of change of decay rates (measured by the time required for 50% of each cohort to be recultivated) at each site over the course of the time series. Individual site trends are shown in the grid at left. Solid lines show simple linear regressions, the slopes of which are shown at right. Gray bands around the linear trends at left and the error bars on slope estimates at the right both represent 95% confidence intervals.

```{r decay-rate-of-change, fig.cap = '(ref:caption-decay-rate-of-change)', echo=FALSE}
knitr::include_graphics(path = paste0(p_plots, run_label,
                                      "/decay/rate_of_change_recultivation_speed_combo", 
                                      "_indiv", run_label, ".pdf"))

# if I go with the linear combination:
# knitr::include_graphics(path = paste0(p_plots, run_label,
#                                       "/decay/rate_of_change_recultivation_speed_combo", 
#                                       "_lincom", run_label, ".pdf"))


# old confidence intervals
# knitr::include_graphics(path = paste0(p_plots, run_label, "/decay/rate_of_change_recultivation_speed_combo",
#                                       "_old", run_label, ".pdf"))


# old version, with quadrants, and old CIs
# knitr::include_graphics(path = paste0(p_plots, run_label, "/presentation/rate_of_change_recultivation_speed", run_label, ".pdf"))
# knitr::include_graphics(path = paste0(p_plots, run_label, "/presentation/rate_of_change_recultivation_speed_old", run_label, ".pdf"))
```

(ref:caption-rate-of-change-diag-resid-fitted) Residuals vs. fitted diagnostic plots for each site, for simple `lm` call corresponding to Eq. \@ref(eq:rate-of-change-lm).

```{r rate-of-change-diag-resid-fitted, fig.cap = '(ref:caption-rate-of-change-diag-resid-fitted)'}
knitr::include_graphics(path = paste0(p_plots, run_label, "/decay/", "rate_of_change_l3_diag_ind_resid_v_fitted", run_label, ".png"))
```

(ref:caption-rate-of-change-diag-qq) QQ plots for each site, calculated using the `car` package (@R-car).

```{r rate-of-change-diag-qq, fig.cap = '(ref:caption-rate-of-change-diag-qq)'}
knitr::include_graphics(path = paste0(p_plots, run_label, "/decay/", "rate_of_change_l3_diag_ind_qq2", run_label, ".png"))
```

(ref:caption-decay-time-to-range) An alternative representation of the mean decay rate for each site (also shown in Figure \@ref(fig:decay-curves-by-site)). The color of each dot corresponds to the proportion remaining after a given amount of time.

```{r decay-time-to-range, fig.cap = '(ref:caption-decay-time-to-range)', echo=FALSE}
# (ref:caption-decay-time-to-range) Sites included in this study, from @Yin2020.
# cite inline using the following  \@ref(fig:decay-time-to-range)

# switch between 1-0 and 1-0.5 by adding or removing all
show_all <- TRUE

knitr::include_graphics(path = paste0(p_plots, run_label, "/decay/time_to_range", 
                                      ifelse(show_all, "_all", ""), "_l3", run_label, ".pdf"))
```


\newpage

## Extrapolating abandonment duration {#section-extrapolation-si}

(ref:caption-extrapolation-combo) The results of our simple extrapolation, including a) the mean age of abandonment, and b) the total area abandoned into the future. Colors corresponding to each site are consistent across the three panels. These extrapolation assume recultivation based on the mean decay trend for each site Figure \@ref(fig:decay-curves-by-site) and annual new abandonment based on the mean annual gain in abandonment shown in Figure \@ref(fig:turnover-grid) (dark green bars).

```{r extrapolation-combo, fig.cap = '(ref:caption-extrapolation-combo)', echo=FALSE}
knitr::include_graphics(path = paste0(p_plots, run_label, "/decay/", 
                                     "extrapolation_combo_SI", run_label, ".pdf"))
```

(ref:caption-extrapolation-area-by-age) Extrapolating area by age bin.

```{r extrapolation-area-by-age, fig.cap = '(ref:caption-extrapolation-area-by-age)', echo=FALSE}
knitr::include_graphics(path = paste0(p_plots, run_label, "/decay/", 
                                      "extrapolate_age_by_age_bin", run_label, ".pdf"))
```

### Alternative assumptions about annual additional abandonment

As noted above, we make two simple assumptions in our extrapolation of abandonment and recultivation: specifically, that 1) recultivation rates remain the same (based on mean recultivation trends at each site, shown in Figure \@ref(fig:decay-curves-by-site), and that 2) a constant amount of cropland is newly abandoned each year, based on the mean annual gain in abandonment shown in Figure \@ref(fig:turnover-grid) (dark green bars).

However, these assumptions may not be very realistic (actually, they almost certainly are not realistic). 
In particular, it is unlikely that a constant amount of land will be newly abandoned each year indefinitely. 
I can think of three alternative assumptions we could make:

1. We could assume that the amount of abandoned land each year would be more likely to gradually decline, so that less and less land is abandoned each year.
2. We could also set a limit to how much total area could be abandoned, perhaps based on a percent of cropland in a site, for example. 
3. Or, finally, we could base this on the trend in abandoned land each year (running a regression on the gain columns in part d of the main results panel figures).

*To do: run this extrapolation for the three different sets of assumptions, and assess the results.*

However, I did it this simple way first, just to illuminate what these trends would mean if they were taken to the extreme. 
And, the extrapolation shows some pretty striking results: many of the sites do not see any land last longer than 20 years. 
The average age of abandonment rarely rises above 20 years, which really isn't that long in terms of carbon storage or biodiversity recovery.

This is not the case in the time series data we have, mostly because at many of the sites, the newer cohorts of land decay more quickly than the older ones. 
Perhaps this is a sign that the least valuable land is abandoned earliest, and therefore is most durable. 
The decay rates for cohorts towards the end of the time series are rather fast at many sites (these cohorts also have the fewest observations), which makes the site average fast as well. 
This is one reason why the mean age is so low in many places. 

#### (*REMOVE*) Alternative mean decay rates

Currently, to get the mean decay rate for each site, I simply average each coefficient (for the log and the linear terms) across all cohorts, and then use these two mean values as the coefficients for the mean site trend (the solid blue lines in Figure \@ref(fig:decay-model-grid)).
I think this makes sense, because it treats each cohort of abandonment equally (rather than giving more weight to cohorts with more observations, i.e. older cohorts). 
Having cohort fixed effects allows for a unique decay rate for each year of abandonment, which makes the models fit very well. 
But, the fits for the recent cohorts with few observations are quite straight. 

Alternatively, however, I can also just run a single regression without the cohort fixed effects, which produces a single estimate for the log and linear coefficients, weighting all points equally (therefore giving more weight to older cohorts with more points; the dashed blue lines in Figure \@ref(fig:decay-model-grid)).

I can then conduct the extrapolation based on the decay rates derived from that single linear regression for each site (in other words, across all cohorts of abandonment).
These extrapolation results are shown below in Figures \@ref(fig:extrapolation-combo-no-fe) and \@ref(fig:extrapolation-area-by-age-no-fe).

However, as you can see, some of the sites have a decay curve that clearly doesn't make sense when extrapolated out (eventually curving upwards over time). 
As a result, I think we should stick with our original method of calculating the mean trend at each site (averaging across the coefficients for each cohort), but I just wanted to call it to your attention.

(ref:caption-extrapolation-combo-no-fe) The results of our simple extrapolation, but assuming a decay trend for each site calculated without cohort fixed effects (a), resulting in b) the mean age of abandonment, and c) the total area abandoned into the future. Colors corresponding to each site are consistent across the three panels.

```{r extrapolation-combo-no-fe, fig.cap = '(ref:caption-extrapolation-combo-no-fe)', echo=FALSE}
knitr::include_graphics(path = paste0(p_plots, run_label, "/decay/", 
                                     "extrapolation_combo_no_fe_tall", run_label, ".pdf"))
```

(ref:caption-extrapolation-area-abn-no-fe) Extrapolating total area abandoned, using site decay rates that do not allow for abandonment cohort fixed effects.

```{r extrapolation-area-abn-no-fe, fig.cap = '(ref:caption-extrapolation-area-abn-no-fe)', include = FALSE, echo=FALSE}
knitr::include_graphics(path = paste0(p_plots, run_label, "/decay/", 
                                      "extrapolate_area_abn_no_fe", run_label, ".png"))
```

(ref:caption-extrapolation-mean-age-no-fe) Extrapolating area by age bin, no fixed effects.

```{r extrapolation-mean-age-no-fe, fig.cap = '(ref:caption-extrapolation-mean-age-no-fe)', include = FALSE, echo=FALSE}
knitr::include_graphics(path = paste0(p_plots, run_label, "/decay/", 
                                      "extrapolate_mean_age_no_fe", run_label, ".png"))
```

(ref:caption-extrapolation-area-by-age-no-fe) Extrapolating area by age bin, assuming site decay rates derived from linear models that do not use cohort fixed effects (treating each observation equally).

```{r extrapolation-area-by-age-no-fe, fig.cap = '(ref:caption-extrapolation-area-by-age-no-fe)', echo=FALSE}
knitr::include_graphics(path = paste0(p_plots, run_label, "/decay/", 
                                      "extrapolate_age_by_age_bin_no_fe", run_label, ".pdf"))
```

\newpage

## Expanded Site Results

### Composite Results Figures

(ref:caption-panel-b) Abandonment patterns for `r site_df$description[1]`, showing a) accumulation of abandoned land by age class, b) decay of abandoned land by year abandoned, c) the area in each land cover class through time (including both land that has been abandoned for five or more years, as well as any land abandoned for 1 or more years, therefore including short-term fallows), d) the annual turnover of abandoned land through time, and e) the distribution of abandonment duration for all periods of cropland abandonment (top) and the maximum duration of abandonment at each pixel (bottom).
(ref:caption-panel-bh) Abandonment patterns for `r site_df$description[2]`, following Figure \@ref(fig:panel-b).
(ref:caption-panel-c) Abandonment patterns for `r site_df$description[3]`, following Figure \@ref(fig:panel-b).
(ref:caption-panel-g) Abandonment patterns for `r site_df$description[4]`, following Figure \@ref(fig:panel-b).
(ref:caption-panel-i) Abandonment patterns for `r site_df$description[5]`, following Figure \@ref(fig:panel-b).
(ref:caption-panel-mg) Abandonment patterns for `r site_df$description[6]`, following Figure \@ref(fig:panel-b).
(ref:caption-panel-n) Abandonment patterns for `r site_df$description[7]`, following Figure \@ref(fig:panel-b).
(ref:caption-panel-o) Abandonment patterns for `r site_df$description[8]`, following Figure \@ref(fig:panel-b).
(ref:caption-panel-s) Abandonment patterns for `r site_df$description[9]`, following Figure \@ref(fig:panel-b).
(ref:caption-panel-v) Abandonment patterns for `r site_df$description[10]`, following Figure \@ref(fig:panel-b).
(ref:caption-panel-w) Abandonment patterns for `r site_df$description[11]`, following Figure \@ref(fig:panel-b).

```{r panel-b, fig.cap = '(ref:caption-panel-b)', echo=FALSE}
# list.files(path = p_plots)

si_panel_figs <- list.files(paste0(p_plots, run_label), pattern = "si_panel", full.names = TRUE)
# grep("_b.png", si_panel_figs, value = TRUE)

knitr::include_graphics(path = si_panel_figs[1])
```

```{r panel-bh, fig.cap = '(ref:caption-panel-bh)', echo=FALSE}
knitr::include_graphics(path = si_panel_figs[2])
```

```{r panel-c, fig.cap = '(ref:caption-panel-c)', echo=FALSE}
knitr::include_graphics(path = si_panel_figs[3])
```

```{r panel-g, fig.cap = '(ref:caption-panel-g)', echo=FALSE}
knitr::include_graphics(path = si_panel_figs[4])
```

```{r panel-i, fig.cap = '(ref:caption-panel-i)', echo=FALSE}
knitr::include_graphics(path = si_panel_figs[5])
```

```{r panel-mg, fig.cap = '(ref:caption-panel-mg)', echo=FALSE}
knitr::include_graphics(path = si_panel_figs[6])
```

```{r panel-n, fig.cap = '(ref:caption-panel-n)', echo=FALSE}
knitr::include_graphics(path = si_panel_figs[7])
```

```{r panel-o, fig.cap = '(ref:caption-panel-o)', echo=FALSE}
knitr::include_graphics(path = si_panel_figs[8])
```

```{r panel-s, fig.cap = '(ref:caption-panel-s)', echo=FALSE}
knitr::include_graphics(path = si_panel_figs[9])
```

```{r panel-v, fig.cap = '(ref:caption-panel-v)', echo=FALSE}
knitr::include_graphics(path = si_panel_figs[10])
```

```{r panel-w, fig.cap = '(ref:caption-panel-w)', echo=FALSE}
knitr::include_graphics(path = si_panel_figs[11])
```

\newpage

### Individual Decay Model Results

(ref:caption-decay-model-indiv-site-b) Decay model results for Eastern Belarus and Smolensk, Russia, showing raw data (green points), modeled abandonment trajectories for individual years (green lines), and the mean decay trajectory for the site as a whole (blue lines). The mean decay trajectory is calculated in two ways: 1) from the mean of the coefficients for each cohort (solid blue line), and 2) as a single linear regression without cohort-level fixed effects (F.E.; dashed blue line).

(ref:caption-decay-model-indiv-site-bh) Decay model results for Bosnia & Herzegovina, showing raw data (green points), modeled abandonment trajectories for individual years (green lines), and the mean decay trajectory for the site as a whole (blue lines). The mean decay trajectory is calculated in two ways: 1) from the mean of the coefficients for each cohort (solid blue line), and 2) as a single linear regression without cohort-level fixed effects (F.E.; dashed blue line).

(ref:caption-decay-model-indiv-site-c) Decay model results for Chongqing Province, China, showing raw data (green points), modeled abandonment trajectories for individual years (green lines), and the mean decay trajectory for the site as a whole (blue lines). The mean decay trajectory is calculated in two ways: 1) from the mean of the coefficients for each cohort (solid blue line), and 2) as a single linear regression without cohort-level fixed effects (F.E.; dashed blue line).

(ref:caption-decay-model-indiv-site-g) Decay model results for Goiás, Brazil, showing raw data (green points), modeled abandonment trajectories for individual years (green lines), and the mean decay trajectory for the site as a whole (blue lines). The mean decay trajectory is calculated in two ways: 1) from the mean of the coefficients for each cohort (solid blue line), and 2) as a single linear regression without cohort-level fixed effects (F.E.; dashed blue line).

(ref:caption-decay-model-indiv-site-i) Decay model results for Iraq, showing raw data (green points), modeled abandonment trajectories for individual years (green lines), and the mean decay trajectory for the site as a whole (blue lines). The mean decay trajectory is calculated in two ways: 1) from the mean of the coefficients for each cohort (solid blue line), and 2) as a single linear regression without cohort-level fixed effects (F.E.; dashed blue line).

(ref:caption-decay-model-indiv-site-mg) Decay model results for Mato Grosso, Brazil, showing raw data (green points), modeled abandonment trajectories for individual years (green lines), and the mean decay trajectory for the site as a whole (blue lines). The mean decay trajectory is calculated in two ways: 1) from the mean of the coefficients for each cohort (solid blue line), and 2) as a single linear regression without cohort-level fixed effects (F.E.; dashed blue line).

(ref:caption-decay-model-indiv-site-n) Decay model results for Nebraska, USA, showing raw data (green points), modeled abandonment trajectories for individual years (green lines), and the mean decay trajectory for the site as a whole (blue lines). The mean decay trajectory is calculated in two ways: 1) from the mean of the coefficients for each cohort (solid blue line), and 2) as a single linear regression without cohort-level fixed effects (F.E.; dashed blue line).

(ref:caption-decay-model-indiv-site-o) Decay model results for Orenburg, Russia, showing raw data (green points), modeled abandonment trajectories for individual years (green lines), and the mean decay trajectory for the site as a whole (blue lines). The mean decay trajectory is calculated in two ways: 1) from the mean of the coefficients for each cohort (solid blue line), and 2) as a single linear regression without cohort-level fixed effects (F.E.; dashed blue line).

(ref:caption-decay-model-indiv-site-s) Decay model results for Shaanxi/Shanxi Provinces, China, showing raw data (green points), modeled abandonment trajectories for individual years (green lines), and the mean decay trajectory for the site as a whole (blue lines). The mean decay trajectory is calculated in two ways: 1) from the mean of the coefficients for each cohort (solid blue line), and 2) as a single linear regression without cohort-level fixed effects (F.E.; dashed blue line).

(ref:caption-decay-model-indiv-site-v) Decay model results for Volgograd, Russia, showing raw data (green points), modeled abandonment trajectories for individual years (green lines), and the mean decay trajectory for the site as a whole (blue lines). The mean decay trajectory is calculated in two ways: 1) from the mean of the coefficients for each cohort (solid blue line), and 2) as a single linear regression without cohort-level fixed effects (F.E.; dashed blue line).

(ref:caption-decay-model-indiv-site-w) Decay model results for Wisconsin, USA, showing raw data (green points), modeled abandonment trajectories for individual years (green lines), and the mean decay trajectory for the site as a whole (blue lines). The mean decay trajectory is calculated in two ways: 1) from the mean of the coefficients for each cohort (solid blue line), and 2) as a single linear regression without cohort-level fixed effects (F.E.; dashed blue line).

```{r decay-model-indiv-site-b, fig.cap = '(ref:caption-decay-model-indiv-site-b)', echo = FALSE}
decay_model_figs <- list.files(paste0(p_plots, run_label, "/decay"), 
                               pattern = paste0("^l3_cohort_plus", run_label), full.names = TRUE)

knitr::include_graphics(path = decay_model_figs[1])
```


```{r decay-model-indiv-site-bh, fig.cap = '(ref:caption-decay-model-indiv-site-bh)', echo=FALSE}
knitr::include_graphics(path = decay_model_figs[2])
```

```{r decay-model-indiv-site-c, fig.cap = '(ref:caption-decay-model-indiv-site-c)', echo=FALSE}
knitr::include_graphics(path = decay_model_figs[3])
```

```{r decay-model-indiv-site-g, fig.cap = '(ref:caption-decay-model-indiv-site-g)', echo=FALSE}
knitr::include_graphics(path = decay_model_figs[4])
```

```{r decay-model-indiv-site-i, fig.cap = '(ref:caption-decay-model-indiv-site-i)', echo=FALSE}
knitr::include_graphics(path = decay_model_figs[5])
```

```{r decay-model-indiv-site-mg, fig.cap = '(ref:caption-decay-model-indiv-site-mg)', echo=FALSE}
knitr::include_graphics(path = decay_model_figs[6])
```

```{r decay-model-indiv-site-n, fig.cap = '(ref:caption-decay-model-indiv-site-n)', echo=FALSE}
knitr::include_graphics(path = decay_model_figs[7])
```

```{r decay-model-indiv-site-o, fig.cap = '(ref:caption-decay-model-indiv-site-o)', echo=FALSE}
knitr::include_graphics(path = decay_model_figs[8])
```

```{r decay-model-indiv-site-s, fig.cap = '(ref:caption-decay-model-indiv-site-s)', echo=FALSE}
knitr::include_graphics(path = decay_model_figs[9])
```

```{r decay-model-indiv-site-v, fig.cap = '(ref:caption-decay-model-indiv-site-v)', echo=FALSE}
knitr::include_graphics(path = decay_model_figs[10])
```

```{r decay-model-indiv-site-w, fig.cap = '(ref:caption-decay-model-indiv-site-w)', echo=FALSE}
knitr::include_graphics(path = decay_model_figs[11])
```
